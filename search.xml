<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>群论手写笔记</title>
      <link href="/2025/02/22/qun-lun-shou-xie-bi-ji/"/>
      <url>/2025/02/22/qun-lun-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>前面杂七杂八的群论1，后面杂七杂八的李群。</p><p><a href="群论笔记.pdf.pdf">下载链接</a></p><embed src="./群论笔记.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 群论 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GroupTheory </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>宇宙学笔记pdf版本</title>
      <link href="/2025/02/22/yu-zhou-xue-bi-ji-pdf-ban-ben/"/>
      <url>/2025/02/22/yu-zhou-xue-bi-ji-pdf-ban-ben/</url>
      
        <content type="html"><![CDATA[<p>持续更新，是宇宙学笔记的pdf版本。</p><p><a href="cosmology.pdf.pdf">下载链接</a></p><embed src="./cosmology.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 宇宙学 </category>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宇宙学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Conformal Field and string</title>
      <link href="/2025/02/22/conformal-field-and-string/"/>
      <url>/2025/02/22/conformal-field-and-string/</url>
      
        <content type="html"><![CDATA[<p>持续更新，没写多少。 <a href="string_theory.pdf">下载链接</a></p><embed src="./string_theory.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 量子场论 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 量子场论 </tag>
            
            <tag> conformal </tag>
            
            <tag> string </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电动力学手写笔记</title>
      <link href="/2024/09/06/dian-dong-li-xue-shou-xie-bi-ji/"/>
      <url>/2024/09/06/dian-dong-li-xue-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="电动力学.pdf">下载链接</a><embed src="./电动力学.pdf" width="100%" height="900" type="application/pdf"></p>]]></content>
      
      
      <categories>
          
          <category> 电动力学 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电动力学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>理论力学手写笔记</title>
      <link href="/2024/09/06/li-lun-li-xue-shou-xie-bi-ji/"/>
      <url>/2024/09/06/li-lun-li-xue-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="理论力学.pdf">下载链接</a><embed src="./理论力学.pdf" width="100%" height="900" type="application/pdf"></p>]]></content>
      
      
      <categories>
          
          <category> 理论力学 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 理论力学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>量子场论手写笔记</title>
      <link href="/2024/06/21/liang-zi-chang-lun-shou-xie-bi-ji/"/>
      <url>/2024/06/21/liang-zi-chang-lun-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>是阅读量子场论时候的手写笔记，一共分为了 5部分（一个部分传不上去）。上面有杂七杂八的计算....可能意义不大吧。占用了好多空间。不知道github有没有对仓库总文件量的限制。----好像是1G。感觉这个手写笔记耗费地方。。。。</p><p><a href="量子场论阅读笔记_1.pdf">下载链接1</a> <ahref="量子场论阅读笔记_2.pdf">下载链接2</a> <ahref="量子场论阅读笔记_3.pdf">下载链接3</a> <ahref="量子场论阅读笔记_4.pdf">下载链接4</a> <ahref="量子场论阅读笔记_5.pdf">下载链接4</a></p><embed src="./量子场论阅读笔记_1.pdf" width="100%" height="900" type="application/pdf"><embed src="./量子场论阅读笔记_2.pdf" width="100%" height="900" type="application/pdf"><embed src="./量子场论阅读笔记_3.pdf" width="100%" height="900" type="application/pdf"><embed src="./量子场论阅读笔记_4.pdf" width="100%" height="900" type="application/pdf"><embed src="./量子场论阅读笔记_5.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 量子场论 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 量子场论 </tag>
            
            <tag> Greiner </tag>
            
            <tag> Srednicki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>量子力学手写笔记</title>
      <link href="/2024/06/14/liang-zi-li-xue-shou-xie-bi-ji/"/>
      <url>/2024/06/14/liang-zi-li-xue-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="量子力学4.pdf">下载链接</a></p><embed src="./量子力学4.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 量子力学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 量子力学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>热统手写笔记</title>
      <link href="/2024/06/14/re-tong-shou-xie-bi-ji/"/>
      <url>/2024/06/14/re-tong-shou-xie-bi-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="热统笔记2.pdf">下载链接</a><embed src="./热统笔记2.pdf" width="100%" height="900" type="application/pdf"></p>]]></content>
      
      
      <categories>
          
          <category> 热力学与统计力学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 热力学与统计力学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>宇宙学课程笔记</title>
      <link href="/2024/06/12/yu-zhou-xue-ke-cheng-bi-ji/"/>
      <url>/2024/06/12/yu-zhou-xue-ke-cheng-bi-ji/</url>
      
        <content type="html"><![CDATA[<h3 id="宇宙学发展简史">宇宙学发展简史</h3><p>宇宙学的研究内容</p><ul><li>时间与空间: 1.几何结构<span class="math inline">\(\to\)</span>平直/弯曲 有限/无限 2.宇宙是静态的or 在演化，演化过程</li><li>宇宙介质:<ol type="1"><li>物质(可见：光子，重子物质；不可见：暗物质)</li><li>这些物质在整个宇宙中的比例，如何影响宇宙的演化。</li><li>暗能量应该如何发现，所占的比例，如何影响宇宙的演化。</li><li>物质，能量的占比是否随着时间演化，在空间中如何分布。</li><li>宇宙的物质形式是否变化，恒星与星系如何形成。</li></ol></li></ul><p>宇宙学的特殊性质</p><ol type="1"><li>研究对象，宇宙只有一个，只能依靠观测和计算机模拟。</li><li>我们在宇宙中的位置固定。</li><li>宇宙演化过程复杂，牵扯知识广泛。</li></ol><p>宇宙学和天体物理，天文学的关系</p><ul><li>天文学包含宇宙学和天体物理</li><li>天体物理 研究单个或者少量的天体，星系</li><li>宇宙学研究整个宇宙的行为</li></ul><p>宇宙学简史</p><ol type="1"><li><p>初期阶段（健康发展1915-1930）</p><p>1915 Einstein GR</p><p>1918 Einstein 提出第一个宇宙学模型（Einstein 模型）.</p><ol type="1"><li>宇宙看作充满全空间的均匀介质。</li><li>宇宙整体上来看静态，引入宇宙学常数<spanclass="math inline">\(\Lambda\)</span>.</li></ol><p>--观测方面</p><p>1920 天文学家发现宇宙膨胀，于是抛弃静态模型</p><p>1923 Slipher观测十多个漩涡星云，首次发现光谱大部分都有红移现象，也就是星云在远离。同一时期，Hubble发现星云实际上是河外星系。(人们意识到宇宙是以星系分子组成的气体)</p><p>1929 Hubble定律提出，星系退行速度与距离成正比。 <spanclass="math inline">\(v\propto d\)</span>. Hubble定律不仅说明宇宙在膨胀而是以保持宇宙均匀性的方式膨胀，方式为一。</p><p>--理论方面</p><p>1923 Friedmann采用不含宇宙学常数的模型，发现宇宙在引力作用下可以膨胀，预言了Hubble定律。</p></li><li><p>第二阶段（挫折阶段 1930-1960）</p><p>挫折原因:（Mpc是<strong>百万秒差距的意思</strong>）</p><ol type="1"><li><p>Hubble 定律<span class="math inline">\(v=H_0d\)</span>, 由于<spanclass="math inline">\(H_0=500km/s/Mpc\)</span>, 宇宙年龄：<spanclass="math inline">\(\frac{1}{H_0}\sim 宇宙年龄\sim 20亿年\)</span>。于是地球有40亿年。</p><p>Friedmann模型的理论基础: 1.均匀性宇宙2.宇宙演化服从GR</p></li><li><p>反推宇宙有初始时刻</p></li></ol><p>1940 Gamov 提出宇宙演化论, 观点： 一切物质形态都不是更古不变的。</p><p><span class="math inline">\(\text{The Big Bang}\to\cdots\to炙热气体\to 元素\to恒星\to星系\)</span></p><p>1950 理论预言10k 左右背景光谱</p><p>1950后期，<span class="math inline">\(H_0\sim 50-100km/s/Mpc\)</span>解决了宇宙年龄矛盾。</p><p>1965宇宙微波背景辐射被发现<span class="math inline">\(\to\)</span>重新重视Hubble-Friedmann-Gamov宇宙理论。</p></li><li><p>第三阶段（蓬勃发展1970-现在）</p><p>发现了：</p><ol type="1"><li>微波背景的各项异性</li><li>宇宙在加速膨胀--暗能量</li><li>发现引力波</li></ol></li></ol><h3 id="宇宙结构">宇宙结构</h3><ul><li><p>宇宙中的结构</p><p>宇宙里的结构按照尺度排列：<strong>恒星，星系，星系群（一半十几个星系），星系团，超星系团，宇宙长城，空洞</strong></p><p>星系：大麦哲伦，本群，仙女座星系(与银河系大小相近的最近的星系,770kPC)</p><p>宇宙长城: BOSS Great Wall and Sloan Great Wall.(13.7亿光年)</p><p>星系团： 室女座超星系团（本群所在星系团），发现他属于LANIZKEA supercluster 其中的结构</p><p>空洞： 宇宙长城的带状结构中间的空隙， （他的尺度是 50MPC）</p><ul><li><p>发现:</p><p>1.大尺度均匀： 在100MPC尺度以上，宇宙可以看作是均匀的。这样一种均匀性的原理叫做宇宙学原理。</p><p>2.其他波段：</p><ul><li><p>微波背景辐射（1950预言 10K CMB）</p><p>观测： 4080MHZ 发现有3.5k过剩天线温度。测量发现温度是各向同性，非极化，与季节无关。</p><p>公证： 从微波到红外都得相近微波背景辐射。</p><p>确定：1989 COBE 卫星，测量三十多个波段的温度，测量得到<spanclass="math inline">\(T_{CMB}=2.725\pm 0.004\)</span></p><p>意义：</p><ol type="1"><li>各向同性CMB的存在支撑宇宙学原理。（各向异性<spanclass="math inline">\(\sim 10^{-5}K\)</span>）</li><li>背景辐射谱和heated高度是一致的（说明光谱来自于宇宙早期，因为宇宙形成后，宇宙不再平衡）</li></ol></li><li><p>红外：主要用来探测年轻的星系</p></li><li><p>X射线：观测星系团中普遍不存在的高温气体。（温度很高，有一千万度）。90%星系团高温气体不在星系中，在星系与星系的空隙之中。比如后发座星系团</p></li><li><p>射电波：研究氢原子的分布(21cm谱线）</p></li><li><p>其他辐射（相对论性的辐射，如粒子等等）</p><ul><li>如中微子(与其他粒子相互作用非常弱)，来自于超新星爆发，可以被大型的探测设备检测到</li><li>引力波</li><li>宇宙射线</li><li>未知的其他物质</li></ul></li></ul></li></ul></li></ul><h3 id="共动坐标哈勃定律红移">共动坐标，哈勃定律，红移</h3><ul><li><p>共动坐标引入</p><p>爱因斯坦基本假设：宇宙是均匀的，静态的。</p><p>弗里德曼基本假设：物质分布是均匀的，各向同性的。</p><p><strong>宇宙学原理</strong>：宇宙在大尺度上是均匀的且各向同性。（下面是宇宙学原理的支持实验）</p><ol type="1"><li>星系分布的大尺度结构在100MPC的尺度上是均匀的</li><li>CMB观测，早期宇宙(宇宙年龄37万年的时候，从大爆炸开始37万年)几乎是均匀且各向同性的。（有<spanclass="math inline">\(10^{-5}\)</span>各项异性，可以和理论对比）</li></ol><p>Q：一个不断膨胀变化的宇宙，如何保持宇宙学的原理。</p><p>A：宇宙中任何位置的相邻组元（星系或者其他）之间的距离需要按照相同的比例变化，变化的速率可以随时间变，但是需要对任意空间点相同。</p><p>于是可以建立一个相对于整个宇宙都静止的坐标系。比如说r，叫做物理坐标系。在这个坐标系下，宇宙组元之间的距离叫做物理距离。</p><p>当宇宙膨胀时候，组元之间的物理距离是发生变化的。但是由于宇宙原理，任意两组相邻组元间的距离之比始终是一定的。</p><p>因此，还可以引入一个随宇宙不断变化的一个坐标系（共动坐标系）。同一组元在共动 坐标系中坐标值不变，比如说x</p><p>物理坐标与共动坐标值差一个只与时间t有关的因子。叫做尺度因子<spanclass="math inline">\(a(t)\)</span>. <span class="math display">\[r(t)=a(t)x\]</span> <span class="math inline">\(a(t)\)</span> 的值代表了t时刻宇宙的大小。<spanclass="math inline">\(\dot{a}(t)\)</span>代表宇宙演化的速率。</p><p>e.g. 举个例子，两个星系当前的距离是150MpC，在<spanclass="math inline">\(a=0.1\)</span>时候，距离就是15Mpc.a的大小就可以用来宇宙时间的早晚。在接近大爆炸时，<spanclass="math inline">\(a\to 0\)</span>.</p><p>任何组元，观测都是一样的。是宇宙学原理的体现。</p><p>Note：真实的宇宙不是精确的满足宇宙学原理。</p></li><li><p>哈勃定律与宇宙膨胀的理解。</p><p>在物理坐标中, <span class="math display">\[v(t)=\frac{dr(t)}{dt}=\frac{\dot{a}}{a}(ax)=H(t)r(t)\]</span> Hubble 定理，物理速度与物理距离成正比，比例系数<spanclass="math inline">\(H(t)\)</span>称为哈勃参数。在<spanclass="math inline">\(t=t_0\)</span>时，这个参数叫做哈勃常数。</p><p>宇宙膨胀的含义。</p><ol type="1"><li>不意味着身体会变大，应为有化学键</li><li>星系之间，比如太阳和地球，引力占主导，不会收到影响。</li><li>只有在100MpC以上时候，才会感受到宇宙膨胀效应。</li></ol><p>本质原因：通常体系的物质密度远大于宇宙的平均物质密度。内部相互作用力远大于膨胀效应。</p><p>当半径很大时候，<spanclass="math inline">\(v=Hr\)</span>可能大于光速，但是由于Hubble是空间本身的膨胀，于是不会破坏因果性。也不会违背狭义相对论。</p><p>星系间距不容易测量，红移容易测量，</p><p>考虑<span class="math inline">\(\lambda_e\)</span>和<spanclass="math inline">\(\lambda_r\)</span>分别是发出和接受到的波长。由于宇宙膨胀，<spanclass="math inline">\(\lambda_e\neq\lambda_r\)</span>. 定义： <spanclass="math display">\[\frac{\lambda_r}{\lambda_e}=1+z\quad z&gt;0\]</span> 固有距离不变：(<span class="math inline">\(r=a(t)x\)</span>),<span class="math display">\[\Deltax=c\int_{t_e}^{t_r}\frac{dt}{a(t)}=\int_{t_e+\frac{\lambda_e}{c}}^{t_r+\frac{\lambda_r}{c}}c\frac{dt}{a(t)}\]</span></p><p><span class="math display">\[0=\frac{\lambda_r}{a(t_r)}-\frac{\lambda_e}{a(t_e)}\]</span></p><p><span class="math display">\[\frac{\lambda_r}{\lambda_e}=\frac{a(t_r)}{a(t_e)}\]</span></p><p><span class="math display">\[z=\frac{1}{a(t)}-1\quad a(t_r)=1\]</span></p></li></ul><h3 id="动力学方程">动力学方程</h3><p>可以建立一个关于<span class="math inline">\(a(t)\)</span>和其他宇宙学变量之间的动力学方程。</p><p>这组方程一共有三个。1.Fridman 方程2.流体方程（守恒性方程）3.物态方程</p><h4 id="fridman-方程">Fridman 方程</h4><p>宇宙均匀，球对称分布的质量密度为<spanclass="math inline">\(\rho(t)\)</span>的宇宙介质。以球心为坐标原点建立坐标系。在r处有质点m。所以他所受到的引力完全来自于球壳内部的介质。（半径为r内的球内）。球外介质贡献为0。质点受到的引力势能是：<span class="math display">\[  V=-\frac{GMm}{r}=-\frac{4}{3}\pi r^2G\rho m\]</span> 质点的总能量： <span class="math display">\[  U=T+V=\frac{1}{2}m\dot{r}^2-\frac{4}{3}\pi r^2G\rho m=Const\]</span> 把<span class="math inline">\(r=a(t)x\)</span> 带入，得到:<span class="math display">\[  \frac{2U}{ma^2x^2}=(\frac{\dot{a}}{a})^2-\frac{8\pi G}{3}\rho\]</span> 定义： <span class="math display">\[  \frac{2U}{mx^2}=-kc^2\]</span> 得到F 方程: <span class="math display">\[  H^2=(\frac{\dot{a}}{a})^2=\frac{8\pi G}{3}\rho-\frac{kc^2}{a^2}\]</span> 常数k的意义：</p><ul><li>F方程的前两项不含x,与x无关。</li><li><spanclass="math inline">\(k=-\frac{2U}{mc^2x^2}\)</span>与t无关，k的量纲是<spanclass="math inline">\([长度]^{-2}\)</span>并且与x,t无关。是空间曲率。</li></ul><p>k大于0，球空间，三角形内角和大于180，圆周长小于<spanclass="math inline">\(2\pi r\)</span> 宇宙类型是封闭。</p><p>k等于0，平空间，三角形内角和等于180，圆周长等于<spanclass="math inline">\(2\pi r\)</span> 宇宙类型是平坦。</p><p>k小于0，双曲空间，三角形内角和小雨180，圆周长大于<spanclass="math inline">\(2\pi r\)</span> 宇宙类型是开放。</p><p>对F方程的讨论。</p><ol type="1"><li>F方程给出了<span class="math inline">\(H(t)\)</span>, <spanclass="math inline">\(\rho(t)\)</span> 和曲率k三者的关系。对当前<spanclass="math inline">\(t=t_0\)</span>, <spanclass="math inline">\(a(t_0)=1\)</span>时。</li></ol><p><span class="math display">\[  H_0^2=\frac{8\pi G}{3}\rho_0-kc^2\]</span></p><ol start="2" type="1"><li><p>如果: <span class="math display">\[\rho(t)=\rho_c(t)=\frac{3H^2}{8\pi G}\]</span> 则<span class="math inline">\(k=0\)</span>。</p><p><span class="math inline">\(\rho_c\)</span>称为临界密度（critical），如果<spanclass="math inline">\(\rho(t)&gt;\rho_c(t)\)</span>, k&gt;0.反之k&lt;0。</p><p>t可以是任意时刻，对于当前<span class="math inline">\(t_0\)</span>,<span class="math inline">\(\rho_c(t_0)=\frac{3H_0^2}{8\piG}\)</span>.</p><p><span class="math inline">\(H_0=100h\; km/s/Mpc\)</span> 其中<strong>h 是一个待测的数值。</strong></p><p><span class="math inline">\(1Mpc=3.0869\times 10^{22}m\)</span>,<span class="math inline">\(G=6.67\times 10^{11}m^3/kg/s\)</span> Mpc中的 M 指 million 百万。pc 指parasec, 秒差距。</p><p>临界密度是 <span class="math inline">\(\rho_c(t_0)=1.88h^2\times10^{-26}kg/m^3\)</span></p><p>考虑到太阳的质量 <span class="math inline">\(M_\circ=2\times10^{30}kg\)</span></p><p><span class="math inline">\(\rho_c(t_0)=2.78 h^2\times10^{11}M_\circ/Mpc^3\)</span></p><p>宇宙的实际密度与<spanclass="math inline">\(\rho_c(t_0)\)</span>差不多。</p><p><spanclass="math inline">\(\rho_c(t)\)</span>相当于200L的水里游一个质子。</p><p>k 测量结果大致是0.7。</p></li><li><p>F 方程的另一种写法。 <span class="math display">\[\frac{\rho}{\rho_c}-\frac{kc^2}{a^2H^2}=1\]</span>方程左边两项都和时间相关，（介质密度参数+曲率密度参数=1）(<spanclass="math inline">\(\Omega+\Omega_k=1\)</span>) <spanclass="math inline">\(\Omega=\sum_i\Omega_i\)</span>.</p><p>大体上说宇宙介质可以分为三类：</p><ol type="1"><li>非相对论物质，静能&gt;（远大于） 势能。</li><li>相对论物质，静能&lt;（远小于）动能。光子，中微子，宇宙早期高温下的重粒子。</li><li>暗能量，<span class="math inline">\(\rho_\Lambda\)</span>,密度参数用<span class="math inline">\(\Omega_\Lambda\)</span>,具有负压强，能使宇宙加速膨胀。本性尚不明确。</li></ol></li></ol><p>#### 流体方程</p><p>两点考虑</p><ol type="1"><li><p>在绝热膨胀成立的尺度上选取任意大小的体积，则净流入和流出该体积的热能必须为0。</p></li><li><p>能量守恒 <span class="math display">\[dE=dQ-pdV=-pdV\]</span></p></li></ol><p>考虑一个<strong>单位半径</strong>的球体，物理体积： <spanclass="math display">\[  V=\frac{4}{3}\pi(ax)^3=\frac{4}{3}\pi a^3\]</span> 总质量：<span class="math inline">\(m=\rho V\)</span>, 总能量:<span class="math inline">\(E=mc^2=\frac{4}{3}\pi a^3\rhoc^2\)</span>.</p><p>该体积内宇宙介质在膨胀过程中满足热力学第一定律。(绝热过程) <spanclass="math display">\[  dE=TdS-pdV=-pdV\]</span></p><p><span class="math display">\[  \frac{dE}{dt}=\frac{4\pi}{3}(3a^2\frac{da}{dt}\rhoc^2+a^3\frac{d\rho}{dt}c^2)\]</span></p><p><span class="math display">\[  \frac{dV}{dt}=4\pi a^2\frac{da}{dt}\]</span></p><p>带入得到: <span class="math display">\[  \dot{\rho}+3\frac{\dot{a}}{a}(\rho+\frac{p}{c^2})=0\]</span> --导致宇宙介质能量变化的原因：</p><ol type="1"><li>宇宙膨胀导致密度降低(括号中的第一项)</li><li>体积膨胀，介质通过压强对外做功(括号中的第二项)</li></ol><p>--由于宇宙学原理，宇宙各处压强相等。(<spanclass="math inline">\(p=p(t)\)</span>不是x的函数，不存在压力，因为压强的梯度等于零)</p><p>--目前已经有了两个方程: <span class="math display">\[  H^2=(\frac{\dot{a}}{a})^2=\frac{8\pi G}{3}\rho-\frac{kc^2}{a^2}\]</span></p><p><span class="math display">\[  \dot{\rho}+3\frac{\dot{a}}{a}(\rho+\frac{p}{c^2})=0\]</span></p><p>得到: <span class="math display">\[  \frac{\ddot{a}}{a}=-\frac{4}{3}\pi G(\rho+\frac{3p}{c^2})\]</span> 由于<span class="math inline">\(\rho&gt;0\)</span>, <spanclass="math inline">\(p&gt;0\)</span>,理论上宇宙减速膨胀，于是要引入暗物质，导致<spanclass="math inline">\(p&lt;0\)</span>。</p><h4 id="物态方程以及宇宙介质的分类">物态方程以及宇宙介质的分类</h4><p>物态方程是关于<span class="math inline">\(p=p(\rho)\)</span>.宇宙学大多数时候考虑最简单的物态方程<span class="math inline">\(p=w\rhoc^2\)</span> (0: 非相对论物质，无压物质，尘埃。<spanclass="math inline">\(\frac{1}{3}\)</span>辐射，相对论物质。<spanclass="math inline">\(-1\)</span>真空能或者宇宙学常数)</p><p>将以上假设带入流体方程: <span class="math display">\[  \frac{\dot{\rho}}{\rho}=-3(1+w)\frac{\dot{a}}{a}\to\rho(a)\proptoa^{-3(1+w)}\]</span> 当得到的<spanclass="math inline">\(\rho(a)\)</span>的关系带入Friedmann方程可以解出<spanclass="math inline">\(a(t)\)</span>.</p><h3 id="宇宙介质">宇宙介质</h3><p>宇宙介质可以分为三类，<span class="math inline">\(p=\omega \rhoc^2\)</span></p><p><span class="math inline">\(w=0\)</span>代表无压物质/非相对论物质/尘埃物质， <spanclass="math inline">\(w=1/3\)</span>代表辐射，<spanclass="math inline">\(w=-1\)</span> 代表宇宙学常数物质</p><p>现在主要介绍宇宙介质的相关知识。</p><ul><li><p>非相对论物质</p><p>代表： 重子物质</p><p><span class="math inline">\(宇宙\leftarrow 原子\leftarrow核子(质子938.3MeV，中子989.6MeV)\leftarrow 夸克\)</span>。</p><p>夸克有六种(u,d,s,c,b,t) p=uud, n=udd。由三个夸克构成的粒子叫做重子。（构成的物质叫做重子物质）。所有重子中只有质子和中子是稳定的。单个中子是不稳定的。原子核内的中子是稳定的。宇宙学中电子也叫做重子物质。</p><p>特征温度 <span class="math display">\[\begin{aligned}mc^2&amp;=k_BT\\k_B&amp;=1.381\times 10^{-23}J/K\\&amp;=8.619\times 10^{-5}eV/K\end{aligned}\]</span> 当实际温度远远小于特征温度时候，粒子是非相对论性的。</p><p>重子物质的比例：4/3 H, 1/4 He,其他元素占据的比较少。</p></li><li><p>辐射</p><p>广义辐射指所有相对论性介质(重子物质在早期也视为辐射)。当前宇宙中的辐射：光子，正反中微子(<spanclass="math inline">\(\nu\;\;\bar{\nu}\)</span>)</p><ul><li><p>光子： <span class="math display">\[m_\gamma=0\quad E=hf=\hbar w=pc\]</span> 假设有一盒光子气体，处于平衡态，平衡温度是T。能量密度是 <spanclass="math display">\[\epsilon(f)df=\frac{8\pi h}{c^3}\frac{f^3}{e^{hf/k_BT}-1}df\]</span> 数密度 <span class="math display">\[n(f)df=\frac{\epsilon(f)df}{hf}\]</span></p><p><span class="math display">\[x=\frac{hf}{k_BT}\]</span></p><p><span class="math inline">\(f_{n-peak}=2.81k_BT\)</span>.</p><p>光子能量密度： <span class="math display">\[\epsilon_\gamma=\int\epsilon(f)df=\alpha T^4\]</span> 光子数密度: <span class="math display">\[n_\gamma=\beta T^3\]</span> 其中: <span class="math display">\[\alpha=\frac{8\pi k_B^4}{c^3h^3}\frac{\pi^4}{15}=7.565\times10^{-16}Jm^{-3}k^{-4}\]</span></p><p><span class="math display">\[\beta=2.029\times 10^{7}m^{-3}K^{-3}\]</span></p><p>一个光子的平均能量: <span class="math display">\[E_{mean}=\frac{E_{total}}{N}=\frac{\epsilon_rV}{nV}=\frac{\epsilon_r}{n}=2.7k_BT\]</span></p></li><li><p>宇宙微波背景辐射</p><p>当前 <span class="math display">\[C_{CMB}=2.7224\pm0.0006K\]</span> 能量密度： <span class="math display">\[\epsilon_{CMB}=0.2606\;MeV/m^3\]</span> 质量密度: <span class="math display">\[\rho_{CMB}=4.639\times 10^{-31}Kg/m^3\]</span> 密度参数: <span class="math display">\[\Omega_{CMB}=\frac{\rho_{CMB,0}}{\rho_{c,0}}\approx 2.47\times10^{-5}h^{-2}\]</span> Q: CMB的光子和星光的能量谁多。</p><p>A: 当前星系的亮度密度 <span class="math display">\[\Psi=1.7\times 10^8\;L_\circ/Mpc^3\approx 2.2\times 10^{-33}Watt/m^3\]</span> 相当于在一个半径为1AU的球内总共30瓦的灯。(1AU是一个天文距离是149,597,870,700m)</p><p>设所有星系从宇宙之初开始 <span class="math display">\[\epsilon_{starlight}=0.006MeV/m^3\]</span> 大约是<spanclass="math inline">\(\epsilon_{CMB}\)</span>的<spanclass="math inline">\(2.3\%\)</span></p><p>数密度: <span class="math display">\[n_{CMB}=411个/{cm^3}\]</span> 平均能量 <span class="math display">\[E_{mean}=2.7k_BT=6.344\times 10^{-4}eV\]</span> 频率: <span class="math display">\[f=\frac{E_{mean}}{h}=1.534\times 10^{11}Hz\quad\lambda=2mm\;\text{属于微波}\]</span></p></li></ul></li></ul><h3 id="中微子">中微子</h3><p>中微子<span class="math inline">\(\nu\)</span>。 中微子<spanclass="math inline">\(\nu\)</span> 是粒子数仅次于<spanclass="math inline">\(\gamma\)</span>的另一种辐射。不放在一起是因为有点长</p><h4 id="简史">.1简史</h4><p>上个世纪初，<span class="math inline">\(\beta\)</span>衰变 <spanclass="math display">\[^{A}_{Z}X\to ^{A}_{Z+1}Y+e^{-}\]</span> 通过能量守恒，发现： <span class="math display">\[E_e=\sqrt{m_e^2+p_e^2}=\frac{m_X^2-m_p^2+m_e^2}{2m_X}\]</span>是一个固定值，但是实际发现，电子的能量测量得到是一个范围：<spanclass="math inline">\([0,E_e]\)</span>。于是认为还有一个中微子。刚开始是叫做Neutron,。后来Fermi把它叫做Neutrino。</p><p>中微子和物质的相互作用非常的弱，难以探测到。</p><p>质疑</p><ul><li><p>1950，Cowan 和Reines用核反应产生大量的<spanclass="math inline">\(\bar{\nu}\)</span>.用两百升的大水箱作为质子靶标来发生<span class="math display">\[p+\bar{\nu}\to n+e^{+}\]</span>产生的正电子和负电子发生湮灭，发出光子。给出了首个中微子存在的证据。</p><p>中微子的产生速率： <span class="math display">\[10^{13}\text{ 个}/cm^2/s\]</span> 但是正电子的产生速率是 <span class="math display">\[2\sim3\text{ 个}/小时\]</span></p></li><li><p>1962年，Lederman, Schwartz, Steinberger 在Brookhaven实验室用<span class="math inline">\(\pi^-\)</span>粒子产生的反中微子作为源。有反应： <span class="math display">\[\bar{\nu}+p^+\to n+\mu^+\]</span> 其中<spanclass="math inline">\(\mu\)</span>子在很多方面和电子有很多相似性。</p><p>也应该能看到反应: <span class="math display">\[\bar{\nu}+p^+\to n+e^+\]</span> 但是下面的反应没有发生，于是有两种中微子: <spanclass="math display">\[\nu_e\quad \nu_\mu\]</span></p></li><li><p>1970 年 Perl 发现一种新的电子和<spanclass="math inline">\(\mu\)</span> 子相似的粒子，叫做<spanclass="math inline">\(\tau\)</span>子。于是认为可能有<spanclass="math inline">\(\nu_\tau\)</span></p></li><li><p>2000 Donut 和 Fermilab 发现了这个粒子</p></li></ul><p>粒子<spanclass="math inline">\(e\mu\tau\;\;\nu_e\;\nu_\tau\;\nu_\mu\)</span>这些粒子和它们的反粒子统称为 轻子。</p><p>Q： 有无更多的轻子？</p><p>1989年，在LEP，通过测量z 玻色子的衰变发现结论: 只产生了三个轻子。</p><p>实验不排除一些情况。</p><p>1.第四代中微子&gt;<spanclass="math inline">\(\frac{m_Z}{2}\)</span>。</p><p>2.可能存在不参与弱相互作用的中微子。</p><h4 id="中微子振荡">.2 中微子振荡</h4><p>1920年 爱丁顿注意到 4个H 比一个He重，说明有可能氢原子聚变成He，这个过程会放出能量。</p><p>1938年，Hans Bethe研究了太阳聚变的一些细节。发现在太阳这种H的恒星重是以PP链的方式发生反应。</p><p>PP 链主要有四个步骤。</p><ol type="1"><li>2p反映成氚。</li><li>氘和P反应成氦3</li><li>氦3和质子反应生成氦4</li><li>氦4和Li反应生成Be，B。</li></ol><p>1968 Ray Davis利用巨型的氯罐在一个矿井下面探测太阳中微子。应该有这样的反应： <spanclass="math display">\[\nu_e+Cl\to Ar+ e^-\]</span> 经过几个月的收集，发现大约每两天能够产生一个Ar原子。Ar原子的个数可以和标准的太阳的模型相互验证。</p><p>收集到的Ar是理论预言的 <spanclass="math inline">\(\frac{1}{3}\)</span>.</p><p>BrunoPontecorov给出了太阳中微子的理论解释。在传播过程中，中微子的味道发生了变化。电子中微子变成了<spanclass="math inline">\(\mu\)</span>中微子，这种味道会发生的连续变化叫做中微子振荡。原因：<span class="math display">\[|\Psi(t)\rangle=e^{-iEt/\hbar}|\Psi(0)\rangle\]</span>初态是不同能量本征态的线性叠加。能量本征态随着时间的变化如上面所示，所以最后得到的态是随着时间震荡的。</p><p>一个电子中微子演化t时间后变化为<spanclass="math inline">\(\mu\)</span>中微子的概率 <spanclass="math display">\[P=[sin(2\theta)\sin(\frac{E_e-E_\nu}{2}t)]^2\]</span> 中微子的质量不可能全为零。 <span class="math display">\[E_i=pc(1+\frac{1}{2}\frac{m_i^2c^2}{p^2})\]</span></p><p><span class="math display">\[P=[sin(2\theta)\sin(\frac{\Delta m^2 L c^2}{4E})]^2\]</span></p><h4 id="续-宇宙中微子">续 ：宇宙中微子</h4><p>宇宙中可能有与CMB类似的C<span class="math inline">\(\nu\)</span>B,理论预言：<span class="math inline">\(T_{C\nu B,0}=1.96K, n_{C\nuB,0}=336/cm^3 (c_{CMB,0}=411/cm^3)\)</span> 若 <spanclass="math inline">\(m_{\nu}=0 \Rightarrow \Omega_{C\nuB,0}=0.681\Omega_{CMB,0}\)</span> 当前 <spanclass="math inline">\(\Omega_{rad,0}=\Omega_{CMB,0}+\Omega_{CMB,0}=4.15\cdot10^{-5}h^{-2}\ll 1\)</span> 对C <span class="math inline">\(\nu\)</span>B直接观测：PTOLEMY, 国内有江门、上交的海铃计划</p><h4 id="第8讲开头">第8讲开头</h4><p>加速or减速？ 减速因子 <spanclass="math inline">\(q=-\frac{\ddot{a}a}{\dot{a}^2}=-\frac{\ddot{a}}{aH^2}\)</span>1990年代，由Perlmutter超新星宇宙学项目(SCP)和由Schmidt和Riess High-ZSupernova Searchteam对大量（几十个）的Ia型超新星（简写为SNIa，这里是罗马数字I）的红移和光通量测量，发现<span class="math inline">\(q_{0}&lt;0\)</span>，即 <spanclass="math inline">\(\ddot{a}&gt;0\)</span> 的证据其他独立观测（CMB,星系形成）<spanclass="math inline">\(\Rightarrow\)</span> 有某种 <spanclass="math inline">\(p&lt;0\)</span> 的组份 2011，诺奖 How &amp; WhySNIa <span class="math inline">\(\Rightarrow\)</span> DE?</p><h4 id="sn1a与光度距离">8.1 SN1a与光度距离</h4><p>根据光谱中有无氯吸收线 <spanclass="math inline">\(\Rightarrow\)</span> I型（无），II型（有）I型中有两类（？）Ia型 <span class="math inline">\(\Rightarrow\)</span>爆发机制（白矮星吸积其伴星上的物质，当其自身质量达到钱德拉塞卡极限 <spanclass="math inline">\(M \sim 1.44M_\odot\)</span> 后 <spanclass="math inline">\(\rightarrow\)</span> 爆炸，炸后不形成BH、中子星）SNIa 非常亮，峰值光度（单位时间发出的能量）<spanclass="math inline">\(L\approx (3\sim 5)\times10^{9}L_{\odot}\)</span>，在 <span class="math inline">\(z\sim1\)</span> 也能看到 <span class="math inline">\(\Rightarrow\)</span>光度大致相同，可作为光度已知的天体，称为标准烛光，从而得到距离光学：已知光度 <span class="math inline">\(L\)</span>, 在距离 <spanclass="math inline">\(d\)</span>处测光通量（单位时间单位面积接收的光能）<spanclass="math inline">\(F=\frac{L}{4\pi d^2}\)</span>，因此，知道 <spanclass="math inline">\(L\)</span> +测出 <spanclass="math inline">\(F\)</span> 就可以知道 <spanclass="math inline">\(d\)</span>. （Note: 这里没有考虑朝向）光速有限，光发出到接收需要时间，这段时间内宇宙会膨胀，因此通过 <spanclass="math inline">\(d_{L}^2=\frac{L}{4\pi F}\)</span>推出的距离称为光度距离 <span class="math inline">\(\neq\)</span>物理距离</p><h4 id="光度距离与物理距离的关系">8.2 光度距离与物理距离的关系</h4><p>Recall 共动距离是不变的，光在 <span class="math inline">\(dt\)</span>时间内走过的共动距离为 <span class="math inline">\(dx=c \cdot\frac{dt}{a(t)}\)</span> 设SNIa在 <spanclass="math inline">\(t_{e}\)</span> 和 <spanclass="math inline">\(t_{e}+\frac{\lambda e}{c}\)</span>时刻发出光子，地球上接收时间为 <spanclass="math inline">\(t_{r}\)</span> 和 <spanclass="math inline">\(t_{r}+\frac{\lambda r}{c}\)</span>,有 <spanclass="math display">\[\int^{t_{e}+\frac{\lambda e}{c}}_{t_{e}} \frac{dt}{a(t)}=\int^{t_{r}+\frac{\lambda r}{c}}_{t_{r}} \frac{dt}{a(t)}\]</span></p><p><span class="math display">\[\frac{\lambda e}{a(t_{e})}=\frac{\lambda r}{a(t_{r})} \Rightarrow\frac{\lambda r}{\lambda e}=\frac{a(t_{r})}{a(t_{e})}=1+z\]</span></p><p><span class="math display">\[t_{r}=t_{0}, a(t_{0})=1 \Rightarrow \frac{1}{a(t)}=1+z\]</span></p><p>膨胀 <span class="math inline">\(a(t_{r})&gt;a(t_{e})\Rightarrowz&gt;0\)</span>，SN发出的光波长变长，<spanclass="math inline">\(\lambda_{r}=(1+z)\lambda_{e}\RightarrowE_{r}=(1+z)^{-1}E_e\)</span> 变小，频率 <spanclass="math inline">\(f_{r}=f_{e}(1+z)^{-1}\)</span>变小，导致光通量不同于宇宙静止时。 设SNIa在 <spanclass="math inline">\(t_{e}\sim t_{e}+\Delta t_{e}\)</span>各向同性，发出N个频率 <span class="math inline">\(f_{e}\)</span>的光子，光度为 <span class="math inline">\(L=\frac{Nhf_{e}}{\Deltat_{e}}\)</span>. 设我们再 <span class="math inline">\(t_{0}\)</span>时收到这些光子，SN与我们的物理距离为 <spanclass="math inline">\(r\)</span>, 收到的光通量 <spanclass="math inline">\(F=\frac{Nhf_{r}}{4\pi r^2\Deltat_{r}}\)</span>，膨胀 <span class="math inline">\(\Rightarrowf_{r}=f_{e}(1+z)^{-1}\)</span> 变小，<span class="math inline">\(\Deltat_{r}=\Delta t_{e}(1+z)\)</span> 变长，从而 <spanclass="math display">\[\frac{L}{F}=4\pi r^2(1+z)^2=4\pi d_{L}^2 \Leftarrow d_{L}=r(1+z)\]</span> 在当前时刻，<span class="math inline">\(r=x=c\int_{t_{e}}^{t_{0}} \frac{dt}{a(t)}, r(t_{e})\rightarrow r(z)\)</span>,由关系 <span class="math inline">\(z=\frac{1}{a}-1\Rightarrow\frac{dz}{dt}=-\frac{\dot{a}}{a^2}\Rightarrow\frac{dt}{a(t)}=-\frac{dz}{H}, r(t_{e})\rightarrow r(z)=\int _{0}^z\frac{cdz}{H(z)}\)</span> 出发点：F方程 <span class="math display">\[H^2=\frac{8\piG}{3}(\rho_{mat}+\rho_{rad}+\rho_{\Lambda})-\frac{kc^2}{a^2},\]</span> 由于 <span class="math inline">\(\rho_{mat}=\rho_{mat,0}\cdota^{-3}, \rho_{rad}=\rho_{rad,0}\cdot a^{-4}, \rho_{\Lambda}=const,a=(1+z)^{-1}\)</span>，有 <span class="math display">\[\begin{aligned}H^2&amp;=H_{0}^2 \frac{8\piG}{3H_{0}^2}[\rho_{mat,0}(1+z)^3+\rho_{rad,0}(1+z)^4+\rho_{\Lambda}+\rho_{K}(1+z)^2]\\&amp;=H_{0}^2[\Omega_{mat,0}(1+z)^3+\Omega_{rad,0}(1+z)^4+\Omega_{\Lambda,0}+\Omega_{K,0}(1+z)^2]\end{aligned}\]</span> 对SNIa， <span class="math display">\[z\sim 1,\quad\Omega_{rad,0},\Omega_{K,0}\ll 1 \Rightarrow\Omega_{mat,0}+\Omega_{\Lambda,0}\approx 1 \Rightarrow\frac{d_{L}H_{0}}{c}=\int _{0}^z\frac{dz&#39;}{[(1-\Omega_{\Lambda,0})(1+z&#39;)^3+\Omega_{\Lambda,0}]^{1/2}}\]</span>+附图1</p><p>测试2第一题</p><h4 id="de的其他性质">8.3 DE的其他性质</h4><p><span class="math inline">\(t_{0}\)</span> 时，F方程的另一种写法<span class="math display">\[\Omega_{mat,0}+\Omega_{rad,0}+\Omega_{\Lambda,0}+\Omega_{K,0}=1\]</span> 认为 <span class="math inline">\(\Omega_{rad}\approx0\)</span>, 以 <spanclass="math inline">\(\Omega_{mat,0},\Omega_{\Lambda,0}\)</span>为变量构造一个二维平面参数空间，存在几条分界线+附图2</p><ul><li><p>当 <span class="math inline">\(\Omega_{K,0}=0\)</span> 时，<spanclass="math inline">\(\Omega_{\Lambda,0}=1-\Omega_{mat,0}\)</span>，线下方<span class="math inline">\(\Omega_{mat,0}+\Omega_{\Lambda,0}&lt;1,\Omega_{K,0}&gt;0, \Omega_{K}\equiv -\frac{kc^2}{a^2H^2}\RightarrowK&lt;0\)</span></p></li><li><p>F方程两边同乘 <span class="math inline">\(a^2\rightarrow\dot{a}^2=\frac{8\piG}{3}a^2[\rho_{mat}+\rho_{rad}+\rho_{\Lambda}]-Kc^2\)</span>，求 <spanclass="math inline">\(t\)</span> 的导数，代入 <spanclass="math inline">\(\dot{\rho}_{mat}=-\frac{3\dot{a}}{a}\rho_{mat},\dot{\rho}_{rad}=-\frac{4\dot{a}}{a}\rho_{rad},\dot{\rho}_{\Lambda}=0\)</span>，整理后有(<spanclass="math inline">\(q=-\frac{\ddot{a}}{a}\frac{1}{H^2}\)</span>) <spanclass="math display">\[q=-\Omega_{\Lambda}+\frac{\Omega_{mat}}{2}+\Omega_{rad}\]</span>当前 <span class="math inline">\(\Omega_{rad,0}\approx 0\Rightarrowq_{0}=\frac{\Omega_{mat,0}}{2}-\Omega_{\Lambda,0}\)</span></p><p>测试2第一题</p></li><li><p>另两类分类（仅了解）<span class="math inline">\(\Rightarrow\Omega_{mat,0}\approx 0.3, \Omega_{\Lambda,0}\approx 0.7\)</span>结论：</p></li><li><p>空间曲率k近似为0</p></li><li><p>当前宇宙在做加速膨胀, <spanclass="math inline">\(q_{0}=\frac{0.3}{2}-0.7\approx-0.55\)</span></p></li><li><p>有BB（Big Bang?），持续膨胀下去 <spanclass="math inline">\(\Lambda CDM\)</span> 模型</p></li></ul><h3 id="第九讲-暗物质简介">第九讲 暗物质简介</h3><h4 id="可见重子物质">9.1可见重子物质</h4><p>太阳，V 波段 <span class="math inline">\(\lambda\in[500,590]\)</span>nm. 在这个波段中，光度，单位时间中辐射出的能量 <spanclass="math display">\[L_{\circ,V}\approx 0.12 \times L_\circ =4.6\times 10^{25} Watts\]</span> 太阳的质光比: 定义为太阳的质量除以太阳的辐射能量=<spanclass="math inline">\(\frac{1M_\circ}{1L_{\circ,V}}=43吨/Watts\)</span></p><p>恒星的质光比不完全相同。</p><p>恒星分为三种 巨星，主序星，矮星 按照质量从小到大，可以分成M,K,G,F。</p><p>M质量大约是0.1个太阳质量，<span class="math inline">\(L_V\approx5\times 10^{-5}L_{\circ V}\)</span> ，他的质光比是太阳的2000倍。</p><p>O 型大约是 60个太阳质量， <span class="math inline">\(L_V\approx2\times 10^{4}L_{\circ V}\)</span>，他的质光比是太阳的0.003倍。</p><p>如果质量小于0.08个太阳质量，存在一些球状的天体，可以视为是气状的球。它们基本上不发光，很难通过这种光的方法来观察他，比如说赫尔星。</p><p>一般来说一个星系中，产生的行星中各种行星的产生率的比率确定，产生O星与M星的比例是250:1。并且O星的寿命是比较短的。比如说时间久了它就会以二型超星星爆发的形式消失了。</p><p>在年轻的星系中<span class="math inline">\(\frac{M}{L_V}\approx 0.3\frac{M_\circ}{L_{\circ,V}}\)</span>。对于成年一些的星系，他的质光比大约是<spanclass="math inline">\(8\frac{M_\circ}{L_{\circ,V}}\)</span>。平均下来，一般认为恒星的质光比是<spanclass="math inline">\(4\frac{M_\circ}{L_{\circ,V}}\)</span></p><p>星系的平均光度密度 <span class="math display">\[\Psi=1.1\times 10^8 L_{\circ,V}/Mpc^3\]</span> 可以算出恒星物质的质量密度: <span class="math display">\[\rho_{*}=&lt;\frac{M}{L_V}&gt;\Psi_V\approx 4\times 10^8\frac{M_\circ}{Mpc^3}\]</span> 按照这个质量密度 <span class="math display">\[\Omega_{*,O}\approx 0.003\]</span> 于是他只贡献重子物质的0.01。</p><p>除了恒星，重子物质还可以以其他形式存在，比如星际气体。比如说M31中，星际气体为恒星质量的20%。 在麦哲伦星云中，星际气体的占比更高。</p><p>星系间气体： Coma Cluster <span class="math inline">\(\sim\)</span>100Mpc。</p><p>最亮的星系是 <span class="math display">\[L_V\approx 2.5\times 10^{11}L_{\circ,V}\]</span> 他是远大于其他星系的，星系的总的光度是： <spanclass="math display">\[L_{Comma,V}=5\times 10^{12}L_{\circ,V}\]</span> 于是 <span class="math display">\[M_{comma,*}\approx 2\times 10^{13}M_\circ\]</span> 而X射线法，大量高温气体，<span class="math inline">\(T\sim10^8k\)</span>, <span class="math inline">\(E\sim 9KeV\)</span>.用流体静力学的方法算出质量。 <span class="math display">\[M_{comma,gas}\sim 2\times 10^{14} M_\circ\]</span>不可见的重子物质，可以用引力透镜的方法测量。星际气体和cluster之外的空洞，..这种不可见的重子物质占比是更多的。</p><h4 id="星系中的暗物质">9.2 星系中的暗物质</h4><p>一个例子：研究漩涡星系的旋转曲线。有扁平的星盘。恒星是绕着中心旋转的。</p><p>一般来讲，向心加速度： <span class="math display">\[a=\frac{v^2}{R}=\frac{GM}{R^2}\]</span> 于是可以算出质量M。 <span class="math display">\[v=\sqrt{\frac{GM}{R}}\]</span> 星盘上的亮度 <span class="math display">\[I(R)=I(0)e^{-R/R_0}\]</span> 特征半径， <span class="math inline">\(R_S\simKpc\)</span>。当离星系中心很远的时候，可以认为<spanclass="math inline">\(M\)</span>就是一个常数了。就是说如果认为星系质量主要来自于恒星，那么气体大约是20%。于是理论预言:<span class="math display">\[v\sim \frac{1}{\sqrt{R}}\]</span> 但是实际观测旋转曲线时候，<spanclass="math inline">\(4R_s&lt;R&lt;6R_s\)</span>时， <spanclass="math inline">\(V(R)\sim 230km/s\)</span>大约是一个常数。</p><p>于是认为星系中有暗物质，它们以暗晕的形式存在。 比如说银河系中<spanclass="math inline">\(R_{halo}=15kpc\)</span>。</p><p>星系团中也有暗物质。星系的径向速度有很大的disporsion。不同星系在径向的平均相对速度是<spanclass="math inline">\(880km/s\)</span>。因为这个相对速度非常快，所以认为已知可见的星系和气体不足以使得星系聚集在这个commacluster中。</p><p>考虑一个模型， 有N个星系，质量是m，</p><p>动能： <span class="math display">\[K=\frac{1}{2}M&lt;v^2&gt;\]</span> 势能: <span class="math display">\[W=-\alpha\frac{GM^2}{r_h}\]</span> 其中的<spanclass="math inline">\(r_h\)</span>叫做半质量半径。转动惯量: <spanclass="math display">\[I=\sum_i m_i |x_i|^2\]</span> 位力定理: <span class="math display">\[\ddot{I}=2W+4K\]</span> 对于稳态 <span class="math display">\[K=-\frac{W}{2}\]</span> 于是 <span class="math display">\[M=\frac{&lt;v^2&gt;r_h}{\alpha G}\]</span> 计算得到<span class="math inline">\(&lt;v^2&gt;\sim 2.32\times10^{12}m/s\)</span>。假设沿着半径质量比是常数 <spanclass="math display">\[r_h=1.5Mpc\]</span> 计算得到总质量<span class="math inline">\(M_{comma}=2\times10^{15}M_\circ\)</span>。 于是可见物质只占有10%</p><p>可以定出重子物质占有的比例是当前宇宙的<spanclass="math inline">\(4\%\sim 5\%\)</span></p><h4 id="引力透镜">9.4引力透镜</h4><p>MACHO （大质量 致密晕状天体）。 褐矮星，冷白矮星，黑洞。</p><p>原理: MACHO 引力使得光线偏转。 <span class="math display">\[\alpha=\frac{4GM}{c^2b}\]</span>当观测别的天体时候，如果路径上有MACHO，那么，看到的是一个圆环，他的角半径：<span class="math display">\[\theta=(\frac{4GM}{c^2d}\frac{1-x}{x})^{1/2}\]</span> d 代表地球到观测天体的距离。 xd 是地球到MACHO的距离。</p><p>如果没有在连线上，观测到的是一些弧。</p><p>但是MACHOS最多占有晕的8%, 别的就是暗物质。</p><h3 id="宇宙学--暗物质ii">11.17 宇宙学--暗物质II</h3><h4 id="课前提问">课前提问</h4><p>什么叫做星系旋转曲线，横坐标是什么，纵坐标是什么。</p><p>答：横坐标是R,纵坐标是v。星系有一些旋臂，上面有一些恒星，横坐标就是距离星系中心的半径R。纵坐标就是v。如果引力全部来自于发光物质，当半径大到一定程度，半径以内的物质质量就是常数，于是<spanclass="math inline">\(v\sim \frac{1}{\sqrt{R}}\)</span>。这是认为只有发光物质。但是实际测量得到<span class="math inline">\(v\simconst\)</span> 。这个事情说明不只有发光物质，就是暗物质。</p><p>另一种方法：</p><p>根据位力定理 <span class="math display">\[\ddot{I}=2W+4K\]</span> 对于稳态， <span class="math display">\[K=-\frac{W}{2}\]</span></p><p><span class="math display">\[W=-\alpha\frac{GM^2}{r_h}\]</span></p><p><span class="math display">\[K=\frac{1}{2}M&lt;v^2&gt;\]</span></p><p>于是 <span class="math display">\[M=\frac{&lt;v^2&gt;r_h}{\alpha G}\]</span> 测量得到总质量远大于可见物质的质量。</p><h3 id="dm-的本质">DM 的本质</h3><ul><li><p>问题： 能不能通过修改引力理论来得到暗物质。</p><p>2006年 Clowe等人通过研究子弹星系团bulletcluster。得到了暗物质存在的最佳证据。（否定了修改引力）。</p><p>BUllet Cluster：通过两个星系团碰撞产生。每个星系团中有发光物质，高温气体，暗物质。</p><p>首先通过X射线望远镜，观察Bulletcluster中高温气体的分布。发现高温气体分布在两个区域。（两个中心）</p><p>回顾一下引力透镜，他的意义在于可以用来探测不发光的天体。</p><p>用引力透镜的方法，可以观察Bulletcluster中物质的分布。观测结果是分布和X射线观测得到的高温气体分布是不一样的。并且他们的质量比例是：<span class="math display">\[M_{星}:M_{气}:M_{总}=1:10:70\]</span> （根据图片--）蓝色的是暗物质，亮点是星系，红色是高温气体。</p><p>说明：</p><ul><li>暗物质和其他重子物质相互作用非常弱。（如图，红色部分的重子物质相互作用比较大）</li><li>暗物质是真实存在的物质。</li></ul><figure><img src="pic/1700208109336.jpg" alt="1700208109336" /><figcaption aria-hidden="true">1700208109336</figcaption></figure></li><li><p>DM问题：很多研究表明宇宙中存在大量于其他物质相互作用很弱，从而很难被探测到或者看到的物质。这样的物质就是暗物质。问题是这些物质本质是什么。</p><p>需要注意的是暗物质并不一定只有一种。</p></li><li><p>暗物质的候选者。有已知存在的比如中微子<spanclass="math inline">\(\nu\)</span>。大多数暗物质候选者是理论假设或者预言的。目前的主流观点大概可以分成两大类。</p><ol type="1"><li><p>基本粒子说：暗物质候选者都是一些相互作用很弱的基本粒子。</p><ol type="a"><li>中微子。宇宙中中微子的粒子数密度大约是<spanclass="math inline">\(n_\nu=3.36\times10^8\;m^{-3}\)</span>。在标准模型中中微子是没有质量的，但是震荡现象说明<spanclass="math inline">\(m_\nu\neq0\)</span>。这个事情可以解释一部分暗物质。假设<spanclass="math inline">\(\nu\)</span>构成了全部的暗物质。通过质量密度,要求<spanclass="math inline">\(\Omega{\nu,0}=\Omega_{dm,0}=0.262\)</span>. <spanclass="math display">\[\Omega_{\nu,0}=\frac{\rho_{\nu,0}}{\rho_{c,0}}=\frac{n_\nu\bar{m}_\nu}{\rho_{c,0}}=0.262\]</span> 于是 <span class="math display">\[\bar{m}_\nu c^2=0.262\times 4870MeV/m^3\frac{1}{3.36\times10^8\;m^{-3}}=3.8eV\]</span>这种轻质量的中微子是属于热暗物质。（指在宇宙的某一个阶段是相对论性的）。</li></ol><p>存在的问题问题：不能解释宇宙大尺度结构的形成。要解释大尺度结构的形成，需要对热暗物质的上限有要求(hdm是hot dark matter) <span class="math display">\[\Omega_{hdm}\leq 0.007\]</span> 相当于要求 <span class="math display">\[\bar{m}_\nu c^2\leq0.007\times 4870MeV/m^3\frac{1}{3.36\times10^8\;m^{-3}}=0.1eV\]</span> 这个也被称作是中微子质量上限。</p><p>于是中微子只能解释一部分暗物质： <span class="math display">\[\frac{\Omega_{\nu,0}}{\Omega_{dm}}\approx\frac{\Omega_{hdm,0}}{\Omega_{dm,0}}&lt;3\%\]</span> 于是说要一些超出标准模型的理论。Beyond Standard Model</p><ol start="2" type="a"><li>超对称，特点：把标准模型的基本粒子基本都复制了一份。比如说把光子对应于超对称伴子photon<spanclass="math inline">\(\to\)</span>photino, 电子<spanclass="math inline">\(\to\)</span> Selection有一些最轻的超对称粒子，他们是稳定不衰变的lighest Supersymmetry Particle(LSP).他们是暗物质的候选者。</li></ol><p>LSP 是WIMP (Weak Interacting MassiveParticles)。这些是指只参与引力和弱相互作用。和中微子类似。但是质量远高于中微子的质量上限0.1eV。</p><p>但是至今是没有结果的。于是目标是另一种粒子（轴子Axion）。这种粒子有好处：<span class="math inline">\(m_{ax}\sim 10^{-5}eV\)</span>。好处在于可以同时解决DM问题和强相互作用中的CP问题。轴子会修改Maxwell理论。在强电磁环境下，轴子会转化为微波频段的光子。实验上用超导高频腔探测。但是目前也没有发现。但是在CM里面，轴子可以作为某些特殊材料的准粒子态出现。（比如说强拓扑绝缘体NatureReviews Physics 2, 2020, p 682）。</p></li><li><p>致密天体说。MACHOs</p><ol type="a"><li><p>原初黑洞：是在宇宙早期形成的黑洞。而不是通过恒星的死亡。可以是重子物质构成。需要早于核合成。(躲避<spanclass="math inline">\(\Omega_{B,0}\approx 0.05\)</span>的限制)</p></li><li><p>MACHOs</p></li></ol></li></ol></li></ul><p>已经了解了当前宇宙中物质的组成和所占的比例。</p><h4 id="宇宙年龄">宇宙年龄</h4><p>通过F方程： <span class="math display">\[(\frac{\dot{a}}{a})^2=\frac{8\pi G}{3}\rho_{tot}\]</span> 其中 <span class="math display">\[\rho_{tot}=\rho_{mat,0}a^{-3}+\rho_{rad,0}a^{-4}+\rho_{\Lambda,0}+\rho_{K,0}a^{-2}\]</span> 在方程的两端同时乘以<spanclass="math inline">\(\frac{a^2}{H_0^2}\)</span> 于是 <spanclass="math inline">\(\rho_{c,0}=\frac{3H_0^2}{8\pi G}\)</span> <spanclass="math display">\[\frac{da}{dt}=H_0\sqrt{\Omega_{mat,0}a^{-1}+\Omega_{rad,0}a^{-2}+\Omega_{\Lambda,0}a^{2}+\Omega_{K,0}}\]</span> 考虑到 <span class="math display">\[\Omega_{rad,0},\Omega_{K,0}&lt;&lt;1,\;\;\Omega_{mat,0}\approx1-\Omega_{\Lambda,0}\approx 0.31\]</span></p><p><span class="math display">\[\int_0^{t_0}dt=t_0\approx\int_0^1\frac{da}{H_0\sqrt{\Omega_{mat,0}a^{-1}+(1-\Omega_{mat,0})a^2}}\]</span></p><p>对a积分得到： <span class="math display">\[t_0=\frac{0.955}{H_0}=0.955t_H\]</span> 带入<span class="math inline">\(H_0=68km/s/Mpc\)</span>,其中<span class="math inline">\(1Mpc=3.068\times 10^{22}m\)</span>于是<span class="math inline">\(t_H=144亿年\)</span>， 于是宇宙年龄： <spanclass="math display">\[t_0\approx137.4亿年\]</span> 地质学说: 地球年龄是50亿年。</p><p>核年代学：星系盘中的铀 100亿年。</p><p>古老球状星团： 100-130亿年</p><h4 id="宇宙可观测半径">宇宙可观测半径</h4><p>光速有限，<spanclass="math inline">\(t_0\)</span>有限，可见宇宙也是有限的。粒子视界半径：指的是在<spanclass="math inline">\(t=0\)</span>时，发出的光子在<spanclass="math inline">\(t_0\)</span>时被接收到，这个时间段中光走过的物理距离。（固有距离）</p><p>光子在<span class="math inline">\(t_e\tot_r\)</span>内走过的共动距离。</p><p><span class="math inline">\(x=c\int_{t_e}^{t_r}\frac{dt}{a(t)}\;\;\;a(t_0)=1\)</span></p><p>当前宇宙的视界半径： <span class="math display">\[d_H=c\int_0^{t_0}\frac{dt}{a(t)}\]</span> 由于： <span class="math display">\[z=\frac{1}{a(t)}-1\to\frac{dz}{dt}=-\frac{\dot{a}}{a^2}=-\frac{\dot{a}}{a}\frac{1}{a}\]</span></p><p><span class="math display">\[\frac{dt}{a}=-\frac{dz}{H}\]</span></p><p><span class="math display">\[d_h=c \int_{0}^{+\infty}\frac{dz&#39;}{H(z&#39;)}\]</span></p><p>由H 方程： 并且：<span class="math inline">\(a^{-3}=(1+z)^3\)</span>,<span class="math inline">\(\Omega_{\Lambda,0}=1-\Omega_{mat,0}\)</span><span class="math display">\[H=H_0\sqrt{\Omega_{mat,0}(1+z)^3+(1-\Omega_{mat,0})}\]</span> 于是 <span class="math display">\[d_h\approx c t_H 3.2=14000Mpc\]</span> 实际上，我们看到的最远的星系，<spanclass="math inline">\(z\approx10\)</span>，于是物理距离： <spanclass="math display">\[ct_H\int_0^{10}\frac{dz&#39;}{\sqrt{\cdots}}\approx2.18ct_H=9500Mpc=\frac{2}{3}d_H\]</span></p><h3 id="上课-第十一讲早期宇宙基础">11.24 上课 第十一讲早期宇宙基础</h3><h4 id="变化的量">11.2变化的量</h4><p>尺度因子 <span class="math inline">\(a(t)\)</span>，物理距离（固有距离）无法测量。可以测量发光天体的红移z。红移和尺度因子之间有关系<span class="math display">\[z=\frac{1}{a(t)}-1=\frac{a(t_0)}{a(t)}-1\]</span>常常将红移作为宇宙演化的主要变量。已知红移的大小可以知道发光天体的很多性质。</p><ol type="1"><li><p>红移z对应的宇宙年龄。(<spanclass="math inline">\(a(t)\)</span>中的 t是多大，也就是发光时候的宇宙年龄是多少。)或者理解为时间坐标，坐标的原点就是大爆炸发生的时候(t=0)。</p><p>求导得到： <span class="math display">\[\frac{dt}{a}=-\frac{dz}{H}\\dt=-\frac{dz}{H}a\\dt=-\frac{dz}{H}(1+z)^{-1}\\\int_0^{t_e}dt=\int_z^{+\infty}\frac{dz}{1+z}\frac{1}{H}\]</span> 其中，z是测量得到的红移值，<spanclass="math inline">\(+\infty\)</span>是在宇宙大爆炸时的红移值。</p></li><li><p>已知红移，还可以计算与z相关的距离。一个是发光体和我们之间的共动距离，<span class="math display">\[d_p=\int_{t_e}^{t_r}c\frac{dt}{a(t)}=c\int^{z}_0\frac{dz&#39;}{H}\]</span> 当前时刻的共动距离 = 当前时刻的物理距离</p><p>二是红移z对应的视界半径。 <span class="math display">\[d_h(z)=c\int_{t=0}^{t_e}\frac{dt}{a(t)}=c\int_z^{\infty}\frac{dz&#39;}{H}\]</span> 上面的计算中需要用到哈勃参数，考虑F方程。 <spanclass="math display">\[H=H_0\sqrt{\Omega_{mat,0}(1+z)^3+\Omega_{rad,0}(1+z)^4+\Omega_{\Lambda,0}+\Omega_{k,0}(1+z)^2}\]</span> 当前时刻： <span class="math display">\[\Omega_{mat,0}+\Omega_{rad,0}+\Omega_{\Lambda,0}+\Omega_{k,0}=1\]</span> 其中: <span class="math display">\[\Omega_{\Lambda,0}=0.69\;\;\Omega_{k,0}=1-\Omega_{\Lambda,0}-\Omega_{mat,0}-\Omega_{rad,0}\]</span>在早期宇宙(z很大)，演化为辐射主导，这时候不能够忽略辐射项。</p><p>利用<spanclass="math inline">\(\rho_{rad}=\rho_{rad,0}a^{-4}\)</span> <spanclass="math inline">\(\rho_{mat}=\rho_{mat,0}a^{-3}\)</span> <spanclass="math inline">\(\rho_\Lambda=常数\)</span>可以得到两个重要时刻：</p><ol type="1"><li><p>辐射-物质等量： <span class="math display">\[\rho_{rad,0}a^{-4}_{rm}=\rho_{mat,0}a^{-3}\]</span> <span class="math inline">\(a_{rm}\sim 2.9\times10^{-4}\)</span> <spanclass="math inline">\(z_{rm}=\frac{1}{a_{rm}}-1\approx 3443\)</span>,实际上现在接收到的最大的红移值是10 左右。<spanclass="math inline">\(t_{rm}\approx 5万年\)</span> 世界半径： <spanclass="math inline">\(d_h(t_{rm})=112Mpc\)</span>。<spanclass="math inline">\(d_h(t_0)=14000Mpc\)</span>.两者的比例大约是125.</p></li><li><p>物质和暗能量等量期。 <span class="math display">\[\rho_{mat}(a_{m\Lambda})=\rho_{\Lambda}\Rightarrowa_{m\Lambda}=(\frac{\Omega_{mat,0}}{\Omega_{\Lambda,0}})^{1/3}=0.77\]</span> ，当时宇宙是现在宇宙的77%。<spanclass="math inline">\(z_{m\Lambda}=0.3\)</span> <spanclass="math inline">\(t_{m\Lambda}=101亿年\)</span>，（现在的30亿年前），视界半径：<spanclass="math inline">\(d_h(t_{m\Lambda})=12880Mpc\)</span>.</p></li></ol></li></ol><h4 id="粒子数守恒">11.2粒子数守恒</h4><p>宇宙微波背景辐射T=2.725k, 黑体谱的能量密度： <spanclass="math inline">\(\epsilon=\alpha T^4=0.2606 MeV/m^3\)</span>,辐射： <span class="math inline">\(\epsilon_\gamma=\rho_\gammac^2\)</span>, <span class="math inline">\(T\sim a^{-1}\)</span> <spanclass="math display">\[T=T_0a^{-1}\approx 3a^{-1}=3(1+z)\quad n_\gamma=\beta T^3\sim a^{-3}\]</span> 对于非相对论粒子，<spanclass="math inline">\(\rho_{mat}=n_{mat}\times m_0\sim a^{-3}\Rightarrown_{mat}\sim a^{-3}\)</span>.发现和相对论物质的粒子数密度的变化规律是一样的。</p><p>稳定的粒子的总数N是守恒的。宇宙膨胀的时候，<spanclass="math inline">\(n=\frac{N}{V}\sim \frac{N}{a^3}\sima^{-3}\)</span> 。</p><p>没有相互作用的时候，N是守恒的，</p><p>有相互作用时候，如果反应很频繁，达到了某种平衡时。粒子数目也守恒<span class="math display">\[H+\gamma\to p+e^{-1}\]</span> 只有在有相互作用，平衡被破坏时候，粒子数不守恒。</p><h4 id="离子原子的电离">11.3 离子，原子的电离</h4><p>考虑<span class="math inline">\(a=10^{-6}\)</span>辐射主导期，CMB气体<span class="math inline">\(T=3\times 10^{6}K\)</span> 光子的能量：<span class="math inline">\(E_{mean}=2.7k_BT=700eV\)</span>。H的电离能，<span class="math inline">\(Q=13.6eV\)</span>。光子气体的能量能够电离氢原子。</p><p>简化模型，认为宇宙中全都是氢原子。</p><p>如果高能光子数目远远大于氢原子数目，则完全电离。</p><p>Q: 宇宙中，光子与重子数目的比例是多少。 <span class="math display">\[n_{\gamma,0}=4.11\times 10^8m^{-3}\]</span> 重子: 核合成的结果：(h=0.68) <span class="math display">\[0.021&lt;\Omega_{B,0}h^2&lt;0.025\]</span> 作为估算，取中间值： <span class="math display">\[\Omega_{B,0}=\frac{\epsilon_{B,0}}{\rho_{c,0}c^2}\approx 0.023h^{-2}\]</span></p><p><span class="math display">\[\epsilon_{B,0}=2.415MeV/m^3\]</span></p><p>又知道重子物质，质子，中子的质量是939MeV。 <spanclass="math display">\[n_{B,0}=0.26m^{-3}\\\frac{n_{\gamma,0}}{n_{B,0}}=1.6\times 10^{9}\]</span> 常用重子，光子数目的比例： <span class="math display">\[\eta=\frac{n_{B,0}}{n_{\gamma,0}}=6\times 10^{-10}\]</span></p><h3 id="第十二讲-复合与退耦">第十二讲 复合与退耦</h3><p><span class="math inline">\(T\sim a^{-1}\)</span>, <spanclass="math inline">\(T_0=3k\)</span> <spanclass="math inline">\(E_{mean}=2.7k_BT\)</span></p><p>上节课讲到，重子和光子的数密度之比，当前时刻<spanclass="math inline">\(\eta=\frac{n_{B,0}}{n_{\gamma,0}}\sim 6\times10^{-10}\)</span>。宇宙的粒子数是守恒的，于是在足够早的时期，这个比值也是成立的。<spanclass="math inline">\(\eta\)</span>在早期也成立。（也不能太早。。。）中性氢原子可以完全电离。完全电离时候，当时宇宙中他的组成：<strong>自由的质子，自由的电子，大量的光子。</strong></p><p>根据粒子物理知识，自由电子会与光子发生Thomson散射。散射结果：这时候的宇宙是不透明的。类似于雾天光子和水蒸气发生散射。</p><p>当宇宙演化，温度逐渐降低，当T降低到不能够使自由质子和电子可以形成中性原子。H原子可以大量形成。中性H原子大量形成的时期叫做复合。（recombination）复合过程会大量消耗自由电子。自由电子减少后使得光子与电子退耦（decoupling不发生散射）。光子退耦后自由传播至今，形成CMB。</p><h4 id="thomson散射">12.1 Thomson散射</h4><p><span class="math display">\[\gamma+e^{-}\to \gamma + e^{-}\]</span></p><p>结论： 散射截面（理解为反应发生的概率） <span class="math display">\[\sigma_e=6.65\times 10^{-29}m^{2}\]</span> 光子的平均发生Thomson散射前走的距离（平均自由程）： <spanclass="math display">\[d=\frac{1}{\sigma_e\cdot n_e}\]</span> 光子的平均碰撞时间：(d/c). Thomson散射的速率： <spanclass="math inline">\(\frac{c}{d}\equiv \Gamma=c\cdot n_e\cdot\sigma_e\)</span> 。其中的<spanclass="math inline">\(n_e\)</span>是会随着宇宙演化发生变化，于是<spanclass="math inline">\(\Gamma\)</span> 是可变的。 在H完全电离时。</p><p>在H完全电离时<span class="math inline">\(n_e=n_p\approx n_B\)</span>（电子数=质子数=重子数）</p><p>由于： <span class="math inline">\(n_e=n_B=n_{B,0}a^{-3}\)</span>,其中<span class="math inline">\(n_{B,0}=0.26 m^{-3}\)</span>. 于是：<span class="math display">\[\Gamma=\frac{5.187\times 10^{-21}/s}{a^{3}}\]</span> 比如<span class="math inline">\(a=10^{-6}\)</span>时候， <spanclass="math inline">\(\Gamma=5.187\times 10^{-3}/s\)</span> 。想观察<spanclass="math inline">\(\Gamma\)</span>什么时候足够小，认为电子和光子作用弱，于是可以作为退耦的判断。</p><p>Q：如何判断<span class="math inline">\(\Gamma\)</span>是大还是小</p><ul><li><span class="math inline">\(\Gamma&gt;H\)</span>，（H为哈勃常数）光子和电子耦合,相互作用平凡（达到平衡），光子温度和电子温度一样。由于电子和质子有电磁作用，于是他们的温度也一样，于是此时光子气体的温度代表了整个宇宙的温度。</li></ul><h4 id="光子的退耦">12.2 光子的退耦</h4><p><span class="math inline">\(\Gamma&lt;H\)</span>光子与电子几乎不再碰撞，也就是退耦。退耦以后宇宙就是透明的了。</p><p><span class="math inline">\(\Gamma=H\)</span>时候，<spanclass="math inline">\(a_{dec}=?\)</span> <spanclass="math inline">\(H(a)=?\)</span>. 想要知道H和a的关系。F 方程(<spanclass="math inline">\(H\sim\rho\)</span>)</p><p>当<span class="math inline">\(a&lt; a_{rm}=2.9\times10^{-4}\)</span>, 宇宙主要以辐射主导。F 方程只考虑辐射的项： <spanclass="math display">\[H^2=\frac{8\pi G}{3}\rho_{rad}\]</span></p><p><span class="math display">\[\rho_{rad}=\rho_{rad,0}a^{-4}\]</span></p><p>于是 <span class="math display">\[H=\frac{H_0\sqrt{\Omega_{rad,0}}}{a^2}\]</span> <span class="math inline">\(H_0=2.203\times10^{-18}s^{-1}\)</span> <span class="math inline">\(H=\frac{2.1\times10^{-20}s^{-1}}{a^2}\)</span> 当<spanclass="math inline">\(a=10^{-5}\)</span>时， <spanclass="math inline">\(H=2.1\times 10^{-10}s^{-1}&lt;&lt;\Gamma=5.187\times 10^{-6}s^{-1}\)</span> , 所以说a要大一些。</p><p>进入到了物质主导期。<spanclass="math inline">\(H=\frac{H_0\sqrt{\Omega_{mat,0}}}{a^{3/2}}\)</span>.令<span class="math inline">\(H=\Gamma\)</span>时候， 解出<spanclass="math inline">\(a=0.026\)</span> 由于 <spanclass="math inline">\(T\sim a^{-1}\sim 100k\)</span>于是光子的平均能量是<span class="math inline">\(0.023eV\)</span>,远远低于氢原子的电离能。所以说这个结果是不能接受的。因为早在<spanclass="math inline">\(T\sim100k\)</span>前，电子已经和质子结合了。于是我们的假设（氢原子完全电离）是错的。这个计算表明复合过程一定发生于退耦之前。复合过程导致电子数<spanclass="math inline">\(n_e\)</span>迅速降低。降低速率比宇宙膨胀导致的减少要快。从而导致光子迅速退耦。退耦是在中性氢原子合成以后迅速完成。</p><p>通过下一讲，复合发生于温度<spanclass="math inline">\(T_{rec}=3760K\)</span> 相应的宇宙年龄<spanclass="math inline">\(t_{rec}=25万年\)</span> 。（发生在物质主导期），相应的红移：(z=1380)。退耦是在复合之后很快进行的，发生时候的温度=2970k, <spanclass="math inline">\(t_{dec}=37万年\)</span>。 红移(z=1090)</p><p>目前接收的CMB光子： 半径为 13850Mpc --- 如何计算： 已知从<spanclass="math inline">\(z_{dec}=1090\)</span> 发出的光子传播到<spanclass="math inline">\(z=0\)</span>. 于是计算共动距离： （前面讲过）<span class="math display">\[d_p(t_0)=\int\frac{cdt}{a(t)}=\int_0^{z_{dec}}\frac{dz&#39;}{H}\]</span> 这个<spanclass="math inline">\(d_p\)</span>形成的球面是叫做最终散射面。（在这个面之后光子是自由传播的）</p><h3 id="第十三讲复合和退耦二">第十三讲，复合和退耦（二）</h3><p><span class="math inline">\(T\sim a^{-1}\)</span>自由电子和光子发生Thomson散射，散射速率<spanclass="math inline">\(\Gamma=n_3\sigma_e c\)</span>, 其中粒子数密度<spanclass="math inline">\(n_e\)</span>随着 a演化而变化。假设在演化过程中自由电子数守恒。<spanclass="math inline">\(n_e\sim a^{-3}\sim T^{3}\)</span> 于是<spanclass="math inline">\(\Gamma(T)\sim T^3\)</span> 。 当<spanclass="math inline">\(\Gamma&gt;H\)</span>,散射频率比较高，光子与电子耦合。</p><p>在物质主导期，哈勃参数H，可以用密度参数写出： <spanclass="math display">\[H=H_0\sqrt{\Omega_{mat,0}}a^{-3/2}=H_0\sqrt{\Omega_{mat,0}}(\frac{T}{T_0})^{3/2}\]</span> 定义退耦是<spanclass="math inline">\(\Gamma=H\)</span>的时候。 <spanclass="math inline">\(a\approx 0.026\)</span>, <spanclass="math inline">\(T_{dec}=100K\sim 0.023eV\)</span>。当温度降低到一定程度以后，<span class="math inline">\(Q\sim13.6eV\)</span>自由电子会被质子（H原子核）或者其他的原子核束缚住，形成中性的原子，这个过程称为复合。复合发生时，自由电子数量不再守恒。所以电子数密度<spanclass="math inline">\(n_e\)</span> 不能够按照<spanclass="math inline">\(T^3\)</span>的方式来下降。而是会以更复杂，更快的方式下降。（比<spanclass="math inline">\(T^3\)</span>的形式更快）因此，要了解退耦，需要了解复合过程。需要知道<spanclass="math inline">\(n_e(T)\)</span>时如何变化的。同时也就知道<spanclass="math inline">\(\Gamma(T)\)</span>。 于是就可以算出<spanclass="math inline">\(T_{dec}\)</span> 。简单起见，考虑氢原子复合 <spanclass="math display">\[p+e^{-}\leftrightarrow H+\gamma\]</span></p><h4 id="电离能">13.1 电离能</h4><p><span class="math inline">\(Q=13.6eV\)</span> 先考虑温度是<spanclass="math inline">\(1eV\)</span>左右的时刻。这时候正逆反应可以达到平衡。随着温度<spanclass="math inline">\(T\)</span>的降低，部分质子开始与电子<spanclass="math inline">\(e^-\)</span>结合，形成氢原子。引入电离度的概念：<span class="math display">\[\chi=\frac{n_p}{n_B}=\frac{n_p}{n_p+n_H}=\frac{n_e}{n_p+n_H}\]</span> <spanclass="math inline">\(n_p\)</span>代表自由质子数密度。<spanclass="math inline">\(n_B\)</span>代表重子总数密度（既包括质子的，也包括<strong>被没有电离的</strong>H原子的数密度）。<span class="math display">\[\frac{1}{\chi}=1+\frac{n_H}{n_e}\]</span> 如果<span class="math inline">\(\chi=1\)</span>,代表完全电离。如果<span class="math inline">\(\chi=0\)</span>,代表重子全都是中性原子。从电离度的定义，可以验证一个等式： <spanclass="math display">\[\frac{1-\chi}{\chi^2}=\frac{\frac{1}{\chi}-1}{\chi}=\frac{n_H}{n_e}\frac{n_B}{n_e}=\frac{n_H}{n_e^2}n_B\]</span> 而<span class="math inline">\(n_B=\eta n_\gamma=\eta\betaT^3\)</span> 于是 <span class="math display">\[\frac{1-\chi}{\chi^2}=\frac{n_H}{n_e^2}\eta\beta T^3=S(T)\]</span> 也就是<spanclass="math inline">\(1-\chi-S(T)\chi^2=0\)</span>。 下面解释为什么<spanclass="math inline">\(\frac{n_H}{n_e^2}\)</span>可以写成温度的函数</p><h4 id="saha-方程">13.2 Saha 方程</h4><p>在<span class="math inline">\(E\sim 1eV\)</span>时， <spanclass="math inline">\(H,p,e^{-}\)</span>都是非相对论的。 (<spanclass="math inline">\(mc^2&gt;&gt;k_BT\)</span>)由统计物理。非相对论粒子的数密度 <span class="math display">\[n_x=g_x\left(\frac{m_xk_BT}{2\pi\hbar^2}\right)^{3/2}e^{\frac{-m_xc^2+\mu_x}{k_BT}}\quadx=H,p,e^-\]</span> 化学平衡条件<spanclass="math inline">\(\mu_H+\mu_\gamma=\mu_p+\mu_e\)</span>由统计物理：<span class="math inline">\(\mu_\gamma=0\)</span>最终得到关系 <span class="math display">\[\mu_H=\mu_p+\mu_e\]</span> 考虑比例关系。 <span class="math display">\[\frac{n_H}{n_e\cdotn_p}=\frac{g_H}{g_eg_p}\left(\frac{m_H}{m_em_p}\frac{2\pi\hbar^2}{k_BT}\right)^{3/2}\timese^{-\beta(m_H-m_e-m_p)c^2}/(k_BT)\]</span> 做如下简化：</p><ol type="1"><li>电中性 <span class="math inline">\(n_e=n_p\)</span></li><li>氢原子电离能<spanclass="math inline">\(Q=(m_e+m_p-m_H)c^2=13.6eV\)</span></li><li><spanclass="math inline">\(\frac{m_H}{mem_p}\approx\frac{1}{m_e}\)</span></li><li><span class="math inline">\(g_P=g_e=2,g_H=4\)</span></li></ol><p>最终得到Saha方程 <span class="math display">\[\frac{n_H}{n_e^2}\eta\betaT^3=\left(\frac{2\pi\hbar^2}{m_ek_BT}\right)^{3/2}e^{Q/k_BT}\eta\betaT^3\equiv S(T)\]</span> 得到电离度S和温度之间的联系 <span class="math display">\[\chi(T)=\frac{-1+\sqrt{1+4S(T)}}{2S(T)}\]</span></p><h4 id="复合">13.3 复合</h4><p>一般把复合定义为电离度<spanclass="math inline">\(\chi\)</span>取某个特定值的时刻。不同的书定义不一样。比如说Liddle书，复合的定义是<spanclass="math inline">\(\chi=0.1\)</span>也就是有90%的质子已经形成了H原子的温度。<spanclass="math inline">\(\frac{n_p}{n_B}=0.1\)</span> Ryden书中说复合的定义是<span class="math inline">\(\chi=0.5\)</span> <spanclass="math inline">\(k_BT=0.324eV=\frac{Q}{42}\)</span> <spanclass="math inline">\(T_{rec}=3760K\)</span></p><p>利用<span class="math inline">\(a\sim T^{-1} \Rightarrowa_{rec}=\frac{2.725K}{3760K}=7.25\times 10^{-4}\)</span></p><p>由于物质-辐射主导期的分界线是<spanclass="math inline">\(a_{rm}=2.9\times 10^{-4}\)</span>。所以复合发生在物质主导期。</p><h4 id="光子的退耦-1">13.4 光子的退耦</h4><p><span class="math display">\[复合开始\Rightarrow n_e快速下降\Rightarrow 光子退耦\]</span></p><p>光子的退耦也发生于物质主导期。物质主导期 <spanclass="math display">\[H=H_0\sqrt{\Omega_{mat,0}}\left(\frac{T}{T_0}\right)^{3/2}\]</span> 退耦： <span class="math display">\[\Gamma(T)=H(T)\]</span> 由于 <span class="math display">\[\Gamma(T)=n_e\sigma_e c\]</span> 利用 <span class="math display">\[\chi=\frac{n_P}{n_B}\]</span> 得到 (<spanclass="math inline">\(\eta\)</span>是光子的重子数之比) <spanclass="math display">\[n_e=\chi \;n_B=\chi\eta\; n_\gamma=\chi\eta\beta T^3\]</span> 带入<span class="math inline">\(\chi\)</span>的具体形式。 于是<span class="math display">\[\Gamma(T)=\chi(T)\eta\beta\;T^3\sigma_e c\]</span> 于是 <span class="math display">\[\Gamma(T)=H(T)\Rightarrow T_{dec}=3.9\times 10^{-4}\quad z_{dec}=1120\]</span> 计算出退耦时候的宇宙年龄 <span class="math display">\[t_{dec}=\int_{zdec}^{+\infty}\frac{dz&#39;}{(1+z&#39;)H(z&#39;)}\approx35.5万年\]</span> 需要注意，SAha方程的成立前提是反应 <spanclass="math display">\[p+e^{-}\leftrightarrow H+\gamma\]</span>是平衡反应。实际上，这个反应在后期会被破坏平衡性。要考虑非平衡效应。最终结果：<span class="math display">\[T_{dec}=2970K\quad z_{dec}=1190\quad t_{dec}=37.1万年\]</span></p><h4 id="宇宙膨胀与光子黑体谱的保持">13.5宇宙膨胀与光子黑体谱的保持</h4><p>CMB是宇宙早期留下来的形成的光子自由传播至今。CMB后，光子数量守恒。</p><p>宇宙膨胀<span class="math inline">\(\Rightarrow\)</span>CMB的性质发生变化</p><ol type="1"><li>数密度减少<span class="math inline">\(n\sim a^{-3}\)</span></li><li>每个光子将发生红移<span class="math inline">\(f\sima^{-1}\)</span></li><li>光子气体温度下降<span class="math inline">\(T\sima^{-1}\)</span></li></ol><p>考虑<span class="math inline">\(a\to a&#39;\)</span>的过程。a时，频率在<span class="math inline">\(f\sim f+df\)</span>内的光子数密度是 <span class="math display">\[n(f)df=c\frac{f^2df}{e^{\frac{hf}{k_BT}}-1}\]</span> 到<spanclass="math inline">\(a&#39;\)</span>时，这些光子的频率是<spanclass="math inline">\(f&#39;=f\frac{a}{a&#39;}\)</span> <spanclass="math display">\[n&#39;(f&#39;)df&#39;=n(f)df(\frac{a}{a&#39;})^3=c\frac{f^2df}{e^{\frac{hf}{k_BT}}-1}(\frac{a}{a&#39;})^3=c\frac{f&#39;^2df&#39;}{e^{\frac{hf&#39;}{k_BT&#39;}}-1}\]</span> 就是说分布仍然是黑体辐射。</p><h3 id="暴涨">暴涨</h3><p>大爆炸理论，宇宙从高温，高密度的初始状态演化。早期宇宙没有中性原子，只有核子电子光子等粒子。1s到1min发生核合成。核合成可以预言H，He等粒子的比例。可以预言轻核的丰度。可以观测早期气体的丰度。</p><p>大爆炸理论存在一些疑难。主要在考虑到极早期宇宙时，疑难会显现出来。解决方案：暴胀，宇宙极早期，（早于核合成，比如<spanclass="math inline">\(10^{-36}s-10^{-34}s\)</span>）一个极短的加速膨胀。暴胀结束后，宇宙按照大爆炸描述的过程演化。</p><ol type="1"><li><p>大爆炸存在的疑难</p><ul><li><p>A、 (flatness, 平直性疑难) CMB, BAO,超新星观测。当前宇宙介质的总密度参数<spanclass="math inline">\(\Omega_{tot}=\Omega_{mat,0}+\Omega_{rad,0}+\Omega_{\Lambda,0}\)</span>三者大约是0.31 <span class="math inline">\(10^{-5}\)</span> 0.96。但是由弗里德曼方程 <spanclass="math inline">\(\Omega_{tot,0}+\Omega_{k,0}=1\)</span>. 说明 <spanclass="math inline">\(\Omega_{k,0}\approx 0\)</span> 说明<spanclass="math inline">\(t_0\)</span>时刻，空间几何近似平直。 <spanclass="math display">\[\Omega_{tot}\equiv \frac{\rho_{tot}}{\rho_c}\quad \text{随时间变化}\]</span></p><p><span class="math display">\[\rho_c=\frac{3H^2}{8\pi G}\quad\rho_{tot}=\rho_{mat}+\rho_{rad}+\rho_{\Lambda}\]</span></p><p>F 方程： <span class="math display">\[H^2=\frac{8\pi G}{3}\rho_{tot}-\frac{kc^2}{a^2}\rightarrow|1-\Omega_{tot}|=\frac{k}{aH^2}\]</span> 如果<span class="math inline">\(\Omega_{tot}=1\)</span>,则<span class="math inline">\(k=0\)</span>。 若<spanclass="math inline">\(\Omega\approx 1\)</span>则 <spanclass="math inline">\(|\Omega_{tot}-1|\)</span>随时间t变化。考虑两种典型的解。</p><ol type="1"><li><p>物质主导： <span class="math display">\[a(t)=(\frac{t}{t_0})^{2/3}\;\; H(t)=\frac{2}{3t}\]</span> 则： <span class="math display">\[|\Omega_{tot}(t)-1|=\frac{|k|}{a^2H^2}\sim t^{2/3}\]</span></p></li><li><p>辐射主导： <span class="math display">\[a(t)=(\frac{t}{t_0})^{1/2}\quad H(t)=\frac{1}{2t}\]</span></p><p><span class="math display">\[|\Omega_{tot}(t)-1|\sim t\]</span></p></li></ol><p>对这两种情况 <span class="math inline">\(|\Omega_{tot}-1|\)</span>都是随着时间单调增。试验观测现在是<spanclass="math inline">\(|\Omega_{tot}-1|\sim 10^{-3}\)</span>，在核合成<span class="math inline">\(t_{nuc}\)</span>的时候。<spanclass="math inline">\(|\Omega_{tot}(t_{nuc})-1|\sim10^{-15}\)</span>。意味着处于平直几何是宇宙的一种不稳定状态。</p></li><li><p>B、视界疑难</p><p>能看到的范围叫做最终散射面。按照大爆炸理论宇宙年龄有限。光速有限，能看到的可观测宇宙有限。CMB观测结果：早期宇宙几乎是各向同性的。T=2.725K</p><p>简单计算：假设宇宙一直是物质主导<spanclass="math inline">\(\Omega_{mat=1}\)</span>, <spanclass="math inline">\(a(t)\sim t^{2/3}\)</span>，取<spanclass="math inline">\(H_0=100km/s/Mpc\)</span> 宇宙年龄<spanclass="math inline">\(t_0=\frac{1}{H_0}\)</span>, 光速<spanclass="math inline">\(c=3\times 10^{-7}Mpc/yr\)</span>从大爆炸到现在，光能传播的最远距离，视界： <span class="math inline">\(ct_0=3000Mpc\)</span>。</p><p>CMB形成于光子退耦时候： <span class="math display">\[\frac{a}{a_{dec}}=1000=(\frac{t_0}{t_{dec}})^{2/3}\rightarrowt_{dec}=10^{11/2}yrs\]</span> 从大爆炸到<spanclass="math inline">\(t_{dec}\)</span>，光子能走的最远距离： <spanclass="math display">\[l_{dec}=c t_{dec}=0.095Mpc\]</span> 相应的共动距离：（当前来看的距离） <spanclass="math display">\[l_{dec}/a_{dec}=1000l_{dec}=95Mpc\]</span> 而我们当前的视界距离是<spanclass="math inline">\(3000Mpc\)</span> ,相应的角度：（代表物质能相互联系的角度） <span class="math display">\[\theta=\frac{95Mpc}{3000Mpc}=2^\circ\]</span></p></li><li><p>C.重粒子残留丰度疑难（磁单极子）</p><p>辐射至少在大爆炸后的一个时间内主导<spanclass="math inline">\(t_{rm}\sim 3万年\)</span>。 <spanclass="math inline">\(\rho_{rad}\sim a^{-4}\)</span>, <spanclass="math inline">\(\rho_{mat}\sim a^{-3}\)</span> <spanclass="math inline">\(\rho_{rad}\)</span>衰减更快。若早期有少量NR重粒子，他们很快占主导。代表：1.大统一理论的磁单极子2.超引力，引力微子 100GeV，<spanclass="math inline">\(S=\frac{3}{2}\)</span> 。超弦理论 spin 0,质量大，很快变成WR。<span class="math inline">\(T_{GUT}\sim 3\times10^{28}k\)</span>, 产生了<spanclass="math inline">\(\Omega_{mon}=10^{-10}\Omega_{rad}\)</span> 则<spanclass="math inline">\(\frac{\Omega_{mon}}{\Omega_{rad}}\sim\frac{1}{T}\)</span>，产生时<spanclass="math inline">\(\frac{\Omega_{mon}}{\Omega_{rad}}|_{T=3\times10^{28}}=10^{-10}\)</span>. 当<span class="math inline">\(T=3\times10^{18}K\)</span>时， <spanclass="math inline">\(\Omega_{mon}=\Omega_{rad}\)</span>,而当 <spanclass="math inline">\(T=3K\)</span>时候，<spanclass="math inline">\(\frac{\Omega_{mon}}{\Omega_{rad}}|_{T=3K}=10^{18}:1\)</span>与观测不符。</p></li></ul></li><li><p>暴胀，加速速膨胀。 <span class="math display">\[p&lt;-\frac{\rho c^2}{3}\quad w&lt;-\frac{1}{3}\]</span> 最简单模型<span class="math inline">\(\Lambda&gt;0\)</span>,<span class="math inline">\(w=-1&lt;-\frac{1}{3}\)</span> , F 方程<spanclass="math inline">\(H^2=\frac{\Lambda}{3}\rightarrowa=e^{\sqrt{\frac{\Lambda}{3}}t}\)</span>.暴胀开始，结束都必须很早。结束时候<spanclass="math inline">\(\Lambda\)</span>的能量传给了物质。一般暴胀模型假设发生于<spanclass="math inline">\(10^{-36}s\)</span>左右，结束于<spanclass="math inline">\(10^{-34}s\)</span>对应GUT的能量 <spanclass="math inline">\(10^{16}GeV\)</span></p><p>解决平直疑难问题：</p><p>存在的原因是 <span class="math display">\[|\Omega_{tot}-1|=\frac{|k|}{a^2H^2}\]</span> 是时间的增函数。在暴胀中，<spanclass="math inline">\(\ddot{a}&gt;0\rightarrow\frac{d}{dt}\dot{a}&gt;0\)</span>也就是 <spanclass="math inline">\(\frac{d}{dt}(\frac{\dot{a}}{a}a)&gt;0\)</span>,也就是<span class="math inline">\(\frac{d}{dt}(Ha)&gt;0\)</span> 指数膨胀：<span class="math display">\[|\Omega_{tot}-1|\sim e^{-\sqrt{\frac{4\Lambda}{3}}t}\]</span> 解决世界疑难问题：</p><p>暴胀前如果有一个区域，处于因果范围内。暴胀结束后的大小比当前宇宙都要大。</p></li><li><p>暴胀的五点假设：</p><ol type="1"><li>暴胀结束于<span class="math inline">\(10^{-34}s\)</span>,</li><li>指数膨胀</li><li>结束至今，辐射主导</li><li>开始前<span class="math inline">\(|\Omega_{tot}-1|\sim1\)</span></li><li>当前时刻<span class="math inline">\(t_0\)</span>, <spanclass="math inline">\(|\Omega_{tot}-1|&lt;0.1\)</span>, 辐射主导期<spanclass="math inline">\(|\Omega_{tot}(t)-1|\sim t\)</span> <spanclass="math inline">\(t_0=4\times 10^{17}s\)</span> ,于是<spanclass="math inline">\(|\Omega_{tot}(t=10^{-34}s)-1|&lt;3\times10^{-53}\)</span> 。在暴胀时期，H为常数，<spanclass="math inline">\(|\Omega_{tot}-1|\sim\frac{1}{a^2}\)</span>,暴胀过程要膨胀<span class="math inline">\(10^{27}\)</span></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> 宇宙学 </category>
          
          <category> 课程笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宇宙学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>群论笔记</title>
      <link href="/2024/06/12/qun-lun-bi-ji/"/>
      <url>/2024/06/12/qun-lun-bi-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="elegantbook-cn.pdf">下载链接</a><embed src="./elegantbook-cn.pdf" width="100%" height="900" type="application/pdf"></p>]]></content>
      
      
      <categories>
          
          <category> 群论 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GroupTheory </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo基础以及github部署</title>
      <link href="/2024/06/12/hexo-ji-chu-yi-ji-github-bu-shu/"/>
      <url>/2024/06/12/hexo-ji-chu-yi-ji-github-bu-shu/</url>
      
        <content type="html"><![CDATA[<p><ahref="https://www.bilibili.com/video/BV1Yb411a7ty/?spm_id_from=333.337.top_right_bar_window_history.content.click&amp;vd_source=2ed6b2cfcd027bbe7f7bac6d27852f66">学习视频b站地址</a></p><p>首先进入管理员模式</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo su</span></span><br></pre></td></tr></table></figure><h3 id="初始化">初始化</h3><p>创建文件夹</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir blog</span><br></pre></td></tr></table></figure><p>进入到创建的文件夹中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> blog/</span><br></pre></td></tr></table></figure><p>在这个文件夹中创建hexo博客系统(有点类似于git中的创建仓库)</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo hexo <span class="keyword">init</span></span><br></pre></td></tr></table></figure><p>show博客，之后会有一个网址，在浏览器中打开即可</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure><p>创建一个新的名字如下的文章，实际上就是生成了一个markdown文件，题目是下面这样。</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="built_in">n</span> <span class="string">&quot;第一个测试文章&quot;</span></span><br></pre></td></tr></table></figure><p>进入到上一步所生成的文章的文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="built_in">source</span>/_posts/</span><br></pre></td></tr></table></figure><p>回退到初始的博客系统文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../..</span><br></pre></td></tr></table></figure><p>我也不知道这个clean操作是干什么，但是每次修改完博客最好clean一下。</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br></pre></td></tr></table></figure><p>generate意思应该是将markdown文件生成为 .html 文件</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br></pre></td></tr></table></figure><p>show博客，前面提到过了</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure><h3 id="github上创建仓库">github上创建仓库</h3><p>仓库的名字叫做</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chenhao-Peng.github.<span class="built_in">io</span></span><br></pre></td></tr></table></figure><h3id="在本地blog目录下安装git的部署插件">在本地blog目录下安装git的部署插件</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install <span class="comment">--save hexo-deployer-git</span></span><br></pre></td></tr></table></figure><h3 id="设置-_config.yml-文件">设置 _config.yml 文件</h3><p>用vim打开config文件。</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim _<span class="built_in">config</span>.yml</span><br></pre></td></tr></table></figure><p>之后滚动到文件的最底部，能找到Deployment 部分，这么写。</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">deploy:</span></span><br><span class="line"><span class="symbol">  type:</span> git</span><br><span class="line"><span class="symbol">  repo:</span> https:<span class="comment">//ghp_HXhQif6iSqWLI8BV0cSG21Dg7SYB********@github.com/Chenhao-Peng/Chenhao-Peng.github.io.git</span></span><br><span class="line"><span class="symbol">  branch:</span> master</span><br></pre></td></tr></table></figure><p>上面的token "ghp..."是从github-设置-开发者设置-Tokens中找到的。</p><p>之后，按一下键盘的esc，然后输入:wq就可以保存退出了。</p><h3 id="将hexo部署到远端">将hexo部署到远端</h3><p>使用命令</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure><p>会让输入github的账号与密码。不过现在需要设置token才可以正常访问。</p><h3 id="更换主题">更换主题</h3><p>比如说，换为github上的yilia主题。在blog目录下，用git命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure><p>将一个主题克隆到了yilia主题下的目录里。</p><p>之后回到_config.yml文件。在这个文件中的Extension 部分，有一个theme:直接把后面的改为yilia就好了。</p><p>之后就是hexo clean, hexo g, hexo d。（清理，生成，部署）</p><h3 id="写文章">写文章</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;title&quot;</span><br></pre></td></tr></table></figure><p>之后，在文章的前面要有类似于这样的标识：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: hexo基础以及github部署</span><br><span class="line">date: 2024-06-12 00:47:17</span><br><span class="line">author: Chenhao Peng</span><br><span class="line">mathjax: true</span><br><span class="line">categories: </span><br><span class="line"><span class="bullet">    -</span> blog</span><br><span class="line"><span class="bullet">    -</span> hexo</span><br><span class="line">tags: </span><br><span class="line"><span class="bullet">    -</span> hexo</span><br><span class="line"><span class="section">    - blog</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算物理课程笔记</title>
      <link href="/2024/06/11/ji-suan-wu-li-ke-cheng-bi-ji/"/>
      <url>/2024/06/11/ji-suan-wu-li-ke-cheng-bi-ji/</url>
      
        <content type="html"><![CDATA[<h3 id="第一章基本数值运算">第一章基本数值运算</h3><h4 id="微分">微分</h4><ul><li><p>向前 <span class="math display">\[\begin{aligned}&amp;f(x_0+h)=f(x_0)+hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(\xi)\\  &amp;\frac{f(x_0+h)-f(x_0)}{h}=f&#39;(x_0)+\frac{h}{2}f&#39;&#39;(\xi)\\  &amp;R=-\frac{h}{2}f&#39;&#39;(\xi)\end{aligned}\]</span></p></li><li><p>向后 <span class="math display">\[\begin{aligned}&amp;f(x_0-h)=f(x_0)-hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(\xi)\\&amp;\frac{f(x_0)-f(x_0-h)}{h}=f&#39;(x_0)-\frac{h}{2}f&#39;&#39;(\xi)\\&amp;R=\frac{h}{2}f&#39;&#39;(\xi)\end{aligned}\]</span></p></li><li><p>中心差分 <span class="math display">\[\begin{aligned}&amp;f(x_0+h)=f(x_0)+hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(x)+\frac{h^3}{3!}f&#39;&#39;&#39;(\xi_{+})\\  &amp;f(x_0-h)=f(x_0)-hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(x)-\frac{h^3}{3!}f&#39;&#39;&#39;(\xi_{-})\\  &amp;\frac{f(x_0+h)-f(x_0-h)}{2h}=f&#39;(x_0)+\frac{h^2}{12}(f&#39;&#39;&#39;(\xi_{+})+f&#39;&#39;&#39;(\xi_{-}))\\  &amp;R=-\frac{h^2}{12}(f&#39;&#39;&#39;(\xi_{+})+f&#39;&#39;&#39;(\xi_{-}))\end{aligned}\]</span></p></li><li><p>五点公式 <span class="math display">\[\begin{aligned}&amp;f(x_0+h)=f(x_0)+hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(x)+\frac{h^3}{3!}f&#39;&#39;&#39;(x)\\&amp;\quad\quad\quad\quad\quad+\frac{h^4}{4!}f^{(4)}(x)+\frac{h^5}{5!}f^{(5)}(\xi_{+})\\&amp;f(x_0-h)=f(x_0)-hf&#39;(x_0)+\frac{h^2}{2}f&#39;&#39;(x)-\frac{h^3}{3!}f&#39;&#39;&#39;(x)\\&amp;\quad\quad\quad\quad\quad+\frac{h^4}{4!}f^{(4)}(x)-\frac{h^5}{5!}f^{(5)}(\xi_{-})\\  &amp;f(x_0+2h)=f(x_0)+2hf&#39;(x_0)+2h^2f&#39;&#39;(x)+\frac{4h^3}{3}f&#39;&#39;&#39;(x)\\  &amp;\quad\quad\quad\quad\quad+\frac{2h^4}{3}f^{(4)}(x)+\frac{(2h)^5}{5!}f^{(5)}(\xi_{+})\\  &amp;f(x_0-2h)=f(x_0)-2hf&#39;(x_0)+2h^2f&#39;&#39;(x)-\frac{4h^3}{3}f&#39;&#39;&#39;(x)\\  &amp;\quad\quad\quad\quad\quad+\frac{2h^4}{3}f^{(4)}(x)-\frac{(2h)^5}{5!}f^{(5)}(\xi_{-})\\&amp; \frac{8(f(x_0+h)-f(x_0-h))-(f(x_0+2h)-f(x_0-2h))}{12h}\\&amp;\quad\quad\quad\quad\quad=f&#39;(x)+O(h^5)\\&amp; R = O(h^5)\end{aligned}\]</span></p></li></ul><h4 id="积分">积分</h4><h5 id="langrange插值法">langrange插值法</h5><ul><li><p>一阶插值 函数已知(<span class="math inline">\(x_0\)</span>,<spanclass="math inline">\(y_0\)</span>),(<spanclass="math inline">\(x_1\)</span>,<spanclass="math inline">\(y_1\)</span>)两点。可以取函数。 <spanclass="math display">\[y = y_0\frac{x-x_1}{x_0-x_1}+y_1\frac{x-x_0}{x_1-x_0}\]</span> 实际上可以引入lagrange插值基函数 <span class="math display">\[l_0(x)=\frac{x-x_1}{x_0-x_1}\\l_1(x)=\frac{x-x_0}{x_1-x_0}\]</span>插值基函数的特点:再角标对应的点数值为1，在其他角标对应的点数值为0</p></li><li><p>高阶插值(比如说n阶)</p><p>函数已知点(<span class="math inline">\(x_0\)</span>,<spanclass="math inline">\(y_0\)</span>),(<spanclass="math inline">\(x_1\)</span>,<spanclass="math inline">\(y_1\)</span>) ... (<spanclass="math inline">\(x_n\)</span>,<spanclass="math inline">\(y_n\)</span>)</p><p>可以取函数: <span class="math display">\[y = y_0l_0(x)+y_1l_1(x)+y_2l_2(x)...+y_nl_n(x)\]</span> 插值基函数: <span class="math display">\[l_i(x)=\frac{(x-x_0)(x-x_1)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)}{(x_i-x_0)(x_i-x_1)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)}\]</span> 比如说二阶插值 <span class="math display">\[y =y_0\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}+y_1\frac{(x-x_0)(x-x_1)}{(x_1-x_0)(x_1-x_2)}+y_2\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}\]</span> 比如说三阶插值 <span class="math display">\[\begin{aligned}y =y_0\frac{(x-x_1)(x-x_2)(x-x_3)}{(x_0-x_1)(x_0-x_2)(x_0-x_3)}+y_1\frac{(x-x_0)(x-x_2)(x-x_3)}{(x_1-x_0)(x_1-x_2)(x_1-x_3)}+\\y_2\frac{(x-x_0)(x-x_1)(x-x_3)}{(x_2-x_0)(x_2-x_1)(x_2-x_3)}+y_3\frac{(x-x_0)(x-x_1)(x-x_2)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}\end{aligned}\]</span></p></li><li><p>runge现象 插值阶数比较高时反而效果不好</p></li></ul><h5 id="三种插值积分方式">三种插值积分方式</h5><ul><li><p>辛普生成公式(simpson)</p><p>考虑三个点(<span class="math inline">\(x_{i}\)</span>,<spanclass="math inline">\(y_{i}\)</span>),(<spanclass="math inline">\(x_{i+1}\)</span>,<spanclass="math inline">\(y_{i+1}\)</span>),(<spanclass="math inline">\(x_{i+2}\)</span>,<spanclass="math inline">\(y_{i+2}\)</span>) <span class="math display">\[y =y_{i}\frac{(x-x_{i+1})(x-x_{i+2})}{(x_i-x_{i+1})(x_i-x_{i+2})}+y_{i+1}\frac{(x-x_i)(x-x_{i+2})}{(x_{i+1}-x_{i})(x_{i+1}-x_{i+2})}\\+y_{i+2}\frac{(x-x_i)(x-x_{i+1})}{(x_{i+2}-x_i)(x_{i+2}-x_{i+1})}\]</span> 将y从<span class="math inline">\(x_i\)</span>积分到<spanclass="math inline">\(x_{i+2}\)</span> <span class="math display">\[I = \int_{x_{i}}^{x_{i+2}}ydx\]</span> 积分得到(<em>草稿E1</em>) <span class="math display">\[\begin{aligned}&amp;I =y_i\frac{-\frac{1}{3}(x_i-x_{i+2})^2+x_i(x_i-x_{i+2})+\frac{1}{2}(x_{i+1}+x_{i+2})(x_i+x_{i+2})-x_i^2-x_{i+1}x_{i+2}}{x_i-x_{i+1}}\\&amp;+y_{i+1}\frac{1}{(x_{i+1}-x_{i})(x_{i+1}-x_{i+2})}\Big(\frac{1}{3}\left((x_{i+2}-x_{i+1}\right)^3-(x_i-x_{i+1})^3)\\&amp;\quad\quad+\frac{1}{2}\left((x_{i+2}-x_{i+1})^2-(x_i-x_{i+1})^2\right)(2x_{i+1}-x_i-x_{i+2})\\&amp;\quad\quad+(x_{i+1}-x_i)(x_{i+1}-x_{i+2})(x_{i+2}-x_i)\Big)\\&amp;+y_{i+2}\frac{1}{(x_{i+2}-x_i)(x_{i+2}-x_{i+1})}\Big(\frac{1}{3}\left((x_{i+2}-x_{i+1})^3-(x_i-x_{i+1})^3\right)\\&amp;\quad\quad+\frac{1}{2}(x_{i+1}-x_i)\left((x_{i+2}-x_{i+1})^2-(x_i-x_{i+1})^2\right)\Big)\end{aligned}\]</span> 若认为<span class="math inline">\(x_i\)</span>,<spanclass="math inline">\(x_{i+1}\)</span>,<spanclass="math inline">\(x_{i+2}\)</span>之间相差h。则简化积分为 <spanclass="math display">\[I=\frac{1}{3}h(y_i+4y_{i+1}+y_{i+2})\]</span> 在此情况下，若将积分区间划分为n等分(从<spanclass="math inline">\(x_0\)</span>到<spanclass="math inline">\(x_n\)</span>,n一定是2的整数倍),h表示相邻两点之间的距离。可以将积分表示为<span class="math display">\[I =\frac{1}{3}h(f(x_0)+4\Sigma_{j=0}^{\frac{n}{2}-1}f(x_0+h+2jh)+2\Sigma_{i=0}^{\frac{n}{2}-2}f(x_0+2h+2jh)+f(x_n))\]</span></p></li><li><p>simpson<spanclass="math inline">\(\frac{3}{8}\)</span>算法。Newton积分公式</p><p>如果已知四个点(<span class="math inline">\(x_{i}\)</span>,<spanclass="math inline">\(y_{i}\)</span>),(<spanclass="math inline">\(x_{i+1}\)</span>,<spanclass="math inline">\(y_{i+1}\)</span>),(<spanclass="math inline">\(x_{i+2}\)</span>,<spanclass="math inline">\(y_{i+2}\)</span>),(<spanclass="math inline">\(x_{i+3}\)</span>,<spanclass="math inline">\(y_{i+3}\)</span>) <span class="math display">\[\begin{aligned}y =&amp;y_i\frac{(x-x_{i+1})(x-x_{i+2})(x-x_{i+3})}{(x_i-x_{i+1})(x_i-x_{i+2})(x_i-x_{i+3})}\\&amp;+y_{i+1}\frac{(x-x_i)(x-x_{i+2})(x-x_{i+3})}{(x_{i+1}-x_i)(x_{i+1}-x_{i+2})(x_{i+1}-x_{i+3})}\\&amp;+y_{i+2}\frac{(x-x_i)(x-x_{i+1})(x-x_{i+3})}{(x_{i+2}-x_i)(x_{i+2}-x_{i+1})(x_{i+2}-x_{i+3})}\\&amp;+y_{i+3}\frac{(x-x_i)(x-x_{i+1})(x-x_{i+2})}{(x_{i+3}-x_i)(x_{i+3}-x_{i+1})(x_{i+3}-x_{i+2})}\end{aligned}\]</span> 在区间<span class="math inline">\(x_{i}\)</span>到<spanclass="math inline">\(x_{i+3}\)</span>之间积分得(认为间距相等且是h)<span class="math display">\[I =\frac{3}{8}h(f(x_i)+3f(x_{i+1})+3f(x_{i+2})+f(x_{i+3}))\]</span> 若将积分区间分为从<spanclass="math inline">\(x_0\)</span>到<spanclass="math inline">\(x_n\)</span>一共n个区间,且n是3得整数倍。 <spanclass="math display">\[\begin{aligned}I =\frac{3}{8}h(f(x_0)+\Sigma_{j=0}^{j=\frac{n}{3}-1}3(f(x_0+h+3jh)+f(x_0+2h+3jh))\\+\Sigma_{j=0}^{j=\frac{n}{3}-2}2f(x_0+3h+3jh)+f(x_0+nh))\end{aligned}\]</span></p></li><li><p>线性插值积分</p><p>如果已知两个点的坐标(<span class="math inline">\(x_i\)</span>,<spanclass="math inline">\(y_i\)</span>),(<spanclass="math inline">\(x_{i+1}\)</span>,<spanclass="math inline">\(y_{i+1}\)</span>) <span class="math display">\[I = \frac{1}{2}h(f(x_i)+f(x_{i+1}))\]</span> 若将区间划分为n等分，从<spanclass="math inline">\(x_0\)</span>到<spanclass="math inline">\(x_n\)</span>。每一份之间距离为h。 <spanclass="math display">\[I = \frac{1}{2}h(f(x_0)+\Sigma_{j=0}^{j=n-2}2f(x_0+h+jh)+f(x_0+nh))\]</span></p></li></ul><p>有一个二重积分的例子几乎用到了所有的技巧:</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第二次课PPT及源程序\第二次课\chap1_integration_double.m&quot;</span></span><br></pre></td></tr></table></figure><h4 id="寻找函数的根">寻找函数的根</h4><h5 id="二分法">二分法</h5><p>二分法的流程:初始化f(x),a,b,<spanclass="math inline">\(\epsilon\)</span>(误差标准)。取x =(a+b)/2。若|b-a|&lt;<spanclass="math inline">\(\epsilon\)</span>,则结束运算,输出x。计算f(x),若f(a)f(x)&gt;0,则a= x,负责令b = x,返回x=(a+b)/2。</p><p>一个老师的例子(<spanclass="math inline">\(f(x)=2x^3-5x-1\)</span>),matlab技巧方面,用了二分法(封装在函数里面)。</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第三次课PPT及源程序\chap1_example_3_bisection_function.m&quot;</span></span><br></pre></td></tr></table></figure><h5 id="newton-raphson方法">newton-Raphson方法</h5><p>newton-Raphson方法的流程: 初始化<spanclass="math inline">\(x_0\)</span>,误差标准<spanclass="math inline">\(\delta\)</span>,<spanclass="math inline">\(\epsilon\)</span>,设置迭代次数k=0。计算<spanclass="math inline">\(x_{k+1}=x_k-\frac{f(x_k)}{f&#39;(x_k)}\)</span>,迭代k= k+1。若<spanclass="math inline">\(|f(x_k)|\leq\delta\land|x_{k+1}-x_k|&lt;\epsilon\)</span>则退出循环。</p><p>老师的一个例子用牛顿法求解<spanclass="math inline">\(f(x)=e^x-1.5-tan^{-1}x\)</span>初始点<spanclass="math inline">\(x_0=-7.0\)</span>,又用二分法在[-16,-7]上面的解</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第三次课PPT及源程序\chap1_example_4_bisection_newton.m&quot;</span></span><br></pre></td></tr></table></figure><h5 id="弦割法">弦割法</h5><p>需要两个启动点 <span class="math display">\[f&#39;(x_k) = \frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}\\x_{k+1} = x_{k}-\frac{f(x_k)}{f&#39;(x_k)}\\\]</span></p><p>停止的标志: <span class="math display">\[|x_{k+1}-x_{k}|&lt;\epsilon \land |f(x_k)|&lt;\delta\]</span> 弦割法的计算流程。初始化<spanclass="math inline">\(x_0\)</span>,<spanclass="math inline">\(x_1\)</span>,误差标准<spanclass="math inline">\(\delta\)</span>和<spanclass="math inline">\(\epsilon\)</span>,设置k=0。若<spanclass="math inline">\(|f(x_K)|\leq\delta\land|x_K-x_{k+1}|\leq\epsilon\)</span>则停止。计算<spanclass="math inline">\(x_{k+1}=x_k-f(x_K)\frac{x_k-x_{k-1}}{f(x_k)-f(x_{k-1})}\)</span>。k=k+1,转到2。</p><p>老师的例:<spanclass="math inline">\(xe^x-1=0,x_0=0.5,x_1=0.6\)</span>,例子程序。</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第三次课PPT及源程序\chap1_example_5_bisection_newton_secant.m&quot;</span></span><br></pre></td></tr></table></figure><ul><li>三种求根方法的总结最好先用二分法找到大概位置，再用另外两个方法找到根的具体位置。</li></ul><h5 id="方程多根">方程多根</h5><ul><li><p>先逐步搜索找到根存在区间，再用上面三种方法找到精确值。老师的一个例子(程序比较复杂233)</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第三次课PPT及源程序\chap1_example_6_several.m&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h5 id="matlab程序">Matlab程序</h5><ul><li>fzero(f,[3,4]) (f是句柄函数)</li><li>roots(c) 多项式的全部零点</li><li>fsolve 非线性方程组的数值解</li></ul><h4 id="微分方程求解">微分方程求解</h4><h5 id="初值问题">初值问题</h5><ul><li>初值问题的题目形式 <span class="math display">\[\frac{dy}{dx}=f(x,y)\\x\in(a,b)\\y(x=a)=y_0\]</span></li></ul><h6 id="euler-法">Euler 法</h6><p><span class="math display">\[y_{n+1}=y_{n}+hf(x_n,y_n)\]</span></p><ul><li>老师课上的例子 <span class="math display">\[m\frac{d^2x}{d^2t}=f(x,t)\\p = m\frac{dx}{dt}\\\frac{dp}{dt}=f(x,t)\\\frac{dx}{dt}=p/m\\x_{n+1}=hp_{n}/m+x_{n+1}\\p_{n+1}=hf(x_n,tn)+p_n\]</span> <figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第四次课PPT及源程序\第四次课PPT及源程序\chapter2_example_2_harmonic_oscillator.m&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h6 id="taylor-级数法">Taylor 级数法</h6><p>误差大概是<span class="math inline">\(h^2\)</span>的量级。 <spanclass="math display">\[y(x_n+h)=y(x_n)+hy&#39;(x_n)+\frac{1}{2}h^2y&#39;&#39;(x_n)\]</span> 实际上 <span class="math display">\[y&#39;(x_n)=f(x_n,y_n)\\y&#39;&#39;(x_n)=\frac{\partial }{\partialx}f(x_n,y_n)+f\frac{\partial}{\partial y}f(x_n,y_n)\]</span></p><h6 id="adams-bashforth-二步法">Adams-Bashforth 二步法</h6><p>需要多个启动点的都叫多步法。 <span class="math display">\[y_{n+1}=y_n+\int_{x_n}^{x_{n+1}}f(x,y(x))dx\\y_{n+1}=y_n+h(\frac{3}{2}f_n-\frac{1}{2}f_{n-1})\]</span></p><h6 id="ab四步法">AB四步法</h6><p><span class="math display">\[y_{n+1}=y_n+h\frac{1}{24}(55f_n-59f_{n-1}+37f_{n-2}-9f_{n-3})\]</span></p><p>启动点用Taylor级数法得到。</p><ul><li>上课的一个例题 <span class="math display">\[\frac{dy}{dx}=-xy  y(0)=1\]</span> <figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;F:\BaiduSyncdisk\计算物理与程序设计\第五次课-计算物理第2章-常  微分方程的初值问题\chapter2_example_4_Adams_Bashforth.m&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h6 id="隐式法">隐式法</h6><p>类似于AB方法，不过在插值时用了<spanclass="math inline">\(f_{n+1}\)</span>这一项。例如:</p><p>因为方程左右都含有<spanclass="math inline">\(y_{n+1}\)</span>,所以叫做隐式法。</p><ul><li><p>Adams-Moulton一步法 <span class="math display">\[\begin{aligned}y(x_{n+1})&amp;=y(x_n)+\int_{x_n}^{x_{n+1}}f(x,y(x))dx\\&amp;=y(x_n)+\int_{x_n}^{x_{n+1}}\left(f_n\frac{x-x_{n+1}}{x_n-x_{n+1}}+f_{n+1}\frac{x-x_n}{x_{n+1}-x_n}\right)dx\\&amp;=y_n+\frac{h}{2}[f_n+f_{n+1}]+O(h^3)\end{aligned}\]</span></p></li><li><p>Adams-Moulton二步法 <span class="math display">\[y_{n+1}=y_n+\frac{h}{12}(5f_{n+1}+8f_n-f_{n-1})\]</span></p></li><li><p>AM三步法 <span class="math display">\[y_{n+1}=y_n+\frac{h}{24}(9f_{n+1}+19f_n-5f_{n-1}+f_{n-2})\]</span></p></li></ul><h6id="对隐式法ab法euler法的一点点讨论">对隐式法,AB法,Euler法的一点点讨论</h6><p>AM隐式法不能直接使用,但是AB和Euler方法可以直接使用,尔后用AM法进行矫正。</p><p>有一个常用的这样的算法是AB四步法和AM三步法的结合</p><h6 id="改进euler方法-梯形公式">改进Euler方法-梯形公式</h6><p><span class="math display">\[y_{n+1}=y_n+hf_n\\y_{n+1}=y_n+h\frac{1}{2}(f_{n+1}+f_n)\]</span></p><p>第一步是预估,第二步是矫正</p><h6 id="rung-kutta算法">Rung-kutta算法</h6><ul><li><p>基本思想 <span class="math display">\[y_{n+1}=y_n+h\Sigma_{i=1}^{N}\lambda_iK_1\\K_1=f(x_n,y_n)\\K_i=f(x_n+hc_i,y_n+hc_i(\Sigma_{j=1}^{i-1}a_{ij}K_j))\]</span>对上面的式子进行taylor展开,要求尽可能多的项数和级数相同。</p></li><li><p>二阶 <span class="math display">\[y_{n+1}=y_n+\frac{h}{2}K_1+\frac{h}{2}K_2\\K_1=f(x_n,y_n)\\K_2=f(x_n+h,y_n+hK_1)\]</span></p></li><li><p>三阶 <span class="math display">\[\begin{aligned}&amp;y_{n+1}=y_n+\frac{h}{6}(K_1+4K_2+K_3)\\&amp;K_1=f(x_n,y_n)\\&amp;K_2=f(x_n+\frac{h}{2},y_n+h\frac{K_1}{2})\\&amp;K_3=f(x_n+h,y_n+h(-K_1+2K_2))\end{aligned}\]</span></p></li><li><p>四阶(认为是最常用的方法) <span class="math display">\[\begin{aligned}&amp;y_{n+1}=y_n+\frac{h}{6}(K_1+2K_2+2K_3+K_4)\\&amp;K_1=f(x_n,y_n)\\&amp;K_2=f(x_n+\frac{h}{2},y_n+\frac{h}{2}K_1)\\&amp;K_3=f(x_n+\frac{h}{2},y_n+\frac{h}{2}K_2)\\&amp;K_4=f(x_n+h,y_n+hK_3)\end{aligned}\]</span></p></li><li><p>注:对于多因变量(比如<spanclass="math inline">\(y_1,y_2,y_3\)</span>),是类似的。</p></li></ul><h6 id="稳定性问题">稳定性问题</h6><p>取实验方程 <span class="math display">\[y&#39;=\lambda y\]</span> 假设在<span class="math inline">\(y_n\)</span>引入了误差<spanclass="math inline">\(\rho_n\)</span>,如果在后面误差绝对值不增加,就说这个数值方法对步长h和<spanclass="math inline">\(\lambda\)</span>常数是稳定的。步长h和<spanclass="math inline">\(\lambda\)</span>有其相应的允许范围,叫做该方法的绝对稳定区域。</p><ul><li>对于四阶RK算法<span class="math inline">\(\frac{dy}{dx}=\lambday\)</span> <span class="math display">\[\rho_{n+1}=[1+(h\lambda)+\frac{(h\lambda)^2}{2!}+\frac{(h\lambda)^3}{3!}+\frac{(h\lambda)^4}{4!}]\rho_n\]</span> 容易得到稳定区域是<span class="math inline">\(\lambdah\in(-2.78,0)\)</span> ###### 常微分方程的numerov算法</li></ul><p>这个算法只能用于特定的微分方程。(很多时候K写为了<spanclass="math inline">\(k^2\)</span>)<br /><span class="math display">\[\frac{d^2y}{dx^2}+K(x)y=S(x)\]</span> 利用二阶导数的差分公式 <span class="math display">\[\frac{y_{n+1}+y_{n-1}-2y_n}{h^2}=\frac{2\frac{1}{2}y^{(2)}h^2+O(h^4)}{h^2}=\frac{2\frac{1}{2}y^{(2)}h^2+2\frac{1}{4!}y^{(4)}h^4+O(h^6)}{h^2}\]</span> 对微分方程求导: <span class="math display">\[\begin{aligned}\frac{d^4y}{dx^4}&amp;=\frac{d^2(S(x)-K(x)y)}{dx^2}\\&amp;=\frac{S_{n+1}+S_{n-1}-2S_n}{h^2}-\frac{K_{n+1}y_{n+1}+K_{n-1}y_{n-1}-2K_{n}y_n}{h^2}+O(h^4)\end{aligned}\]</span> 而: <span class="math display">\[\begin{aligned}S_n-K_ny_n=&amp;\frac{y_{n+1}+y_{n-1}-2y_n}{h^2}\\&amp;-\frac{1}{12}(S_{n+1}+S_{n-1}-2S_n-K_{n+1}y_{n+1}-K_{n-1}y_{n-1}+2K_{n}y_n)\\&amp;+O(h^4)\end{aligned}\]</span> 可以将上式写为<spanclass="math inline">\(y_{n+1},y_{n-1},y_n\)</span>的递推关系 <spanclass="math display">\[\begin{aligned}y_{n+1}&amp;(1+\frac{1}{12}h^2K_{n+1})+y_{n-1}(1+\frac{1}{12}h^2K_{n-1})+2y_n(-1+\frac{5}{12}h^2K_n)\\&amp;=\frac{h^2}{12}(S_{n+1}+10S_n+S_{n-1})\end{aligned}\]</span> 这个解法不可以自启动,一般设置启动点的方法是泰勒级数法。 <spanclass="math display">\[y_1=y_0+hy_0&#39;+\frac{1}{2}h^2y_0&#39;&#39;\]</span></p><h3id="第三章-常微分方程的边值问题与本征值问题">第三章-常微分方程的边值问题与本征值问题</h3><h4 id="边值问题的解">边值问题的解</h4><h5 id="线性边值问题的迭加法">线性边值问题的迭加法</h5><p>问题描述 <span class="math display">\[y&#39;&#39;=f(x,y,y&#39;)\]</span> 如果可以写为 <span class="math display">\[y&#39;&#39;+p(x)y&#39;+q(x)y=f(x)\]</span> 则方程组是线性的。</p><p>如果边值问题可以被描述为<spanclass="math inline">\(y(x=a)=\alpha,y(x=b)=\beta\)</span>,则可以视为两组边值结果线性叠加的效果<spanclass="math inline">\((y(a)=\alpha,y&#39;(a)=0,y&#39;&#39;+p(x)y&#39;+q(x)y=f(x));(y(a)=0,y&#39;(a)=1,y&#39;&#39;+p(x)y&#39;+q(x)y=0)\)</span></p><p>将他们的解分别记为<span class="math inline">\(y_1\)</span>与<spanclass="math inline">\(y_2\)</span>,则总的解可以写为。 <spanclass="math display">\[y(x)=y_1(x)+\frac{\beta-y_1(b)}{y_2(b)}y_2(x)\]</span></p><h5 id="非线性边值问题的打靶法">非线性边值问题的打靶法</h5><p>定义初始条件:<spanclass="math inline">\(y(a)=\alpha,y&#39;(a)=s\)</span>,则可以根据常微分方程的初值问题的解法得到<spanclass="math inline">\(y(b,s)\)</span></p><p>考虑方程 <span class="math display">\[F(s)=y(b,s)-\beta\]</span> 求下一个点的公式可以用弦割法: <span class="math display">\[s_{k+1} = s_{k}-\frac{s_k-s_{k-1}}{y(b,s_k)-y(b,s_{k-1})}(y(b,s)-\beta)\]</span></p><ol type="1"><li>给定初始点的斜率猜测值S1；</li><li>用常微分方程的初值问题解法（如RK算法）求解y(b,S1);</li><li>给出另一个斜率猜测值S2作为弦割法的第二个启动点;</li><li>用常微分方程的初值问题解法（如RK算法）求解y(b,S2);</li><li>IF (abs(y(b,S1)-y(b))&lt;精度 ), y(x)=y(x,S1);</li><li>IF (abs(y(b,S2)-y(b))&lt;精度 ), y(x)=y(x,S2); else</li><li>利用弦割法迭代公式求出下一个斜率S3；</li><li>用常微分方程的初值问题解法（如RK算法）求解y(b,S3);</li><li>IF (abs(y(b,S3)-y(b))&lt;精度  ), y(x)=y(x,S3); else S1=S2;S2=S3；回到第7步</li><li>得到边值问题的解y(x)=y(x,S3);</li></ol><ul><li>三类边值问题对应打靶法的参数选取<ul><li>第一类边值问题<spanclass="math inline">\(y(a)=\alpha,y(b)=\beta\)</span>,显而易见,取<spanclass="math inline">\(y&#39;(a)=s\)</span>为参数</li><li>第二类边值问题<spanclass="math inline">\(y&#39;(a)=\alpha,y&#39;(b)=\beta\)</span>,取<spanclass="math inline">\(y(a)\)</span>为参数</li><li>第三类边值问题<spanclass="math inline">\(y&#39;(a)=\beta_0+\alpha_0y(a),y&#39;(b)=\beta_1+\alpha_1y(b)\)</span>可以将<spanclass="math inline">\(y(a)\)</span>取为参数<spanclass="math inline">\(y_0\)</span>,则<spanclass="math inline">\(y&#39;(a)=\beta_0+\alpha_0y_0\)</span></li></ul></li></ul><h5 id="线性常微分方程的差分方法">线性常微分方程的差分方法</h5><p><spanclass="math display">\[y&#39;&#39;+p(x)y&#39;+q(x)y=f(x)\]</span></p><p>将差分表示的微商带入 <span class="math display">\[\frac{y_{n+1}+y_{n-1}-2y_n}{h^2}+p(x_n)\frac{y_{n+1}-y_{n-1}}{2h}+q(x_n)y_n=f(x)\]</span> 即 <span class="math display">\[y_{n-1}(2-hp(x_n))+y_n(-4+2h^2q(x_n))+y_{n+1}(2+hp(x_n))=2h^2f(x_n)\]</span></p><p>考虑 <span class="math inline">\(y_0,y_1...y_{n-1}\)</span>(n-1)个点,与n-1个方程</p><p><span class="math display">\[\begin{equation}\begin{aligned}\begin{bmatrix}2-hp_1 &amp; -4+2h^2q_1 &amp; 2+hp_1 &amp;  ... &amp; ...  &amp; ...  \\... &amp; 2-hp_2 &amp; -4+2h^2q_2 &amp;  2+hp_2 &amp; ...  &amp; ...  \\... &amp; ... &amp; ... &amp;  ... &amp; ...  &amp; ...  \\... &amp; ... &amp; ... &amp;  ... &amp; ...  &amp; ...  \\... &amp; ... &amp;... &amp; 2-hp_{n-1}  &amp; -4+2h^2q_{n-1}  &amp;2-hp_{n-1}  \\\end{bmatrix}\begin{bmatrix}y_0\\y_1\\...\\y_{n-1}\\y_{n}\end{bmatrix}\\=\begin{bmatrix}2h^2f_0\\2h^2f_1\\...\\2h^2f_{n-1}\\2h^2f_{n}\end{bmatrix}\end{aligned}\end{equation}\]</span></p><p>但是有n+1个未知数,需要再带上两个边界的方程。总之就是把上面的矩阵扩展为方形。</p><h4 id="本征值问题的解">本征值问题的解:</h4><p>比如说波动方程的分离变量后的空间部分 <span class="math display">\[y&#39;&#39;-k^2y=0\]</span> 可以取初始条件<spanclass="math inline">\(y(x=0)=\alpha,y&#39;(x=0)=\delta\)</span>.<spanclass="math inline">\(\delta\)</span>实际上可以随便取值.....因为方程是其次的,而且在边界点的函数值刚好是0。然后就用二分法的打靶法,将k设置为参量,即可。##### 求解薛定谔方程的本征值问题 <spanclass="math inline">\(schr\ddot{o}dinger\)</span> -Equation一般表示为:<span class="math display">\[\begin{align*}\frac{\partial^2}{\partialx^2}\psi(x)+\frac{2m}{\hbar^2}(E-V(x))\psi=0\\\frac{\partial^2}{\partial x^2}\psi(x)+(\epsilon-v(x))\psi=0\end{align*}\]</span> 其中,<span class="math inline">\(\epsilon =\frac{2m}{\hbar^2}E\)</span>, <spanclass="math inline">\(v(x)=\frac{2m}{\hbar^2}V(x)\)</span>.一般认为这类方程只在一定的区间内需要被考虑,比如说<spanclass="math inline">\([x_{min},x_{max}]\)</span>,在这个区间之外,一般认为<spanclass="math inline">\(v(x)\to +\infty\)</span> ,所以相当于波函数就是0了。而在这个区间内,我们经常把势能写成一个凹函数,并且满足<spanclass="math inline">\(v(x_{min})=v(x_{max})=0\)</span>。我们一般考虑束缚态,这样E&lt;0。这样，满足<spanclass="math inline">\(E-V(x)\)</span>的区间我们可以标记为<spanclass="math inline">\([x_{m1},x_{m2}]\)</span>。我们的解法是分别给定初值条件: <span class="math display">\[\begin{align}\begin{cases}\psi_{&lt;}(x_{min})=0\\\frac{\partial}{\partial x}\psi_{&lt;}(x_{min})=\delta\end{cases}\\\begin{cases}\psi_{&gt;}(x_{\max})=0\\\frac{\partial}{\partial x}\psi_{&gt;}(x_{max})=\delta&#39;\end{cases}\end{align}\]</span> 这样可以得到两个解<spanclass="math inline">\(\psi_{&lt;}(x)\)</span>和<spanclass="math inline">\(\psi_{&gt;}(x)\)</span>。我们要做的具体工作是:先设定本征值,解出两个解,再对其中一个乘以系数,使得他们在<spanclass="math inline">\(\psi(x_{m1})\)</span>处的函数值相等,然后再用向后差分的方法,对比两者再<spanclass="math inline">\(x_{m1}\)</span>点的一阶导数是否一样,如果一样,就认为这个本征值就是方程的本征值。</p><h3 id="第四章-偏微分方程的数值求解">第四章 偏微分方程的数值求解</h3><h4 id="偏微分方程的分类">偏微分方程的分类</h4><p>二阶偏微分方程常见的形式可以写为 <span class="math display">\[AU_{xx}+2BU_{xy}+CU_{yy}+DU_x+EU_y+FU=0\]</span> 其中,<spanclass="math inline">\(A,B,C\)</span>为参数且取决于x,y。如果再xy平面上有<span class="math inline">\(A^2+B^2+C^2&gt;0\)</span>,则该偏微分方程再该平面上为二阶偏微分方程。 * 如果<spanclass="math inline">\(B^2-AC&lt;0\)</span>, 则为椭圆形方程。 * 如果<spanclass="math inline">\(B^2-AC=0\)</span>, 则为抛物型方程。 * 如果<spanclass="math inline">\(B^2-AC&gt;0\)</span>, 则为双曲型方程。 ####椭圆形方程的求解 ##### 什么是椭圆形方程Poisson方程在这里实际上是椭圆形方程的代表 Possion方程可以写为: <spanclass="math display">\[\Delta u = \nabla^2(u)=\frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}=S(x,y)\]</span> ##### Jacobi 迭代法 将空间划分为一些格点<spanclass="math inline">\(u_{i,j}\)</span>用来表示x方向第i个,y方向第j个格点。 先假设u有一个分布叫做<spanclass="math inline">\(u^0\)</span>, 利用差分法,迭代得到下一次的分布。<span class="math display">\[\frac{u_{i+1,j}^n+u_{i-1,j}^n-2u_{i,j}^{n+1}}{h_1^2}+\frac{u_{i,j+1}^n+u_{i,j-1}^n-2u_{i,j}^{n+1}}{h_2^2}=S_{i,j}^n\]</span>上面的式子中,n代表上一次的分布,n+1代表下一次的分布,理论上,当迭代前后在一个格点上函数值没有变化时，说明找到了possion方程的解。将上面的式子化简之后得到的式子是: <span class="math display">\[u_{i,j}^{n+1}=(\frac{u_{i+1,j}^n+u_{i-1,j}^n}{h_1^2}+\frac{u_{i,j+1}^n+u_{i,j-1}^n}{h_2^2}-S_{i,j}^n)\frac{1}{\frac{2}{h_1^2}+\frac{2}{h_2^2}}\tag{1}\]</span> ##### Gauss-Seidel松弛迭代法 在[[计算物理#Jacobi迭代法|Jacobi迭代法]],我们在迭代生成<spanclass="math inline">\(u^{n+1}_{i,j}\)</span>时,实际上已经有算出<spanclass="math inline">\(u_{i-1,j}^{n+1},u_{i,j-1}^{n+1}\)</span>。在这样的情况下,我们可以用已经算出来的函数值来修正Jacobi迭代法。按照这个思想, 迭代后的函数值可以表示为: <span class="math display">\[\begin{aligned}u_{i,j}^{n+1}=(1-w)(\frac{u_{i+1,j}^n+u_{i-1,j}^n}{h_1^2}+\frac{u_{i,j+1}^n+u_{i,j-1}^n}{h_2^2}-S_{i,j}^n)\frac{1}{\frac{2}{h_1^2}+\frac{2}{h_2^2}}+\\w(\frac{u_{i+1,j}^n+u_{i-1,j}^{n+1}}{h_1^2}+\frac{u_{i,j+1}^n+u_{i,j-1}^{n+1}}{h_2^2}-S_{i,j}^n)\frac{1}{\frac{2}{h_1^2}+\frac{2}{h_2^2}}\end{aligned}\]</span> #### 抛物型方程的求解 ##### 什么是抛物型方程<strong>传导问题</strong>的<strong>扩散方程</strong>是典型的抛物型方程。方程的形式一般为: <span class="math display">\[\frac{\partial\Phi}{\partial t}=\frac{\partial^2\Phi}{\partialx^2}+S(x,t)\]</span> ##### 显式差分法下面的式子中的下角标代表着坐标空间(实际上就是坐标),上角标代表着时间空间(代表着时间)。<span class="math display">\[\begin{aligned}\frac{\Phi_i^{n+1}-\Phi_{i}^{n}}{\Deltat}=\frac{\Phi^n_{i+1}+\Phi^{n}_{i-1}-2\Phi_i^n}{h^2}+S^n\end{aligned}\]</span> <span class="math display">\[\Phi_i^{n+1}=\Phi_i^n+\frac{\Deltat}{h^2}(\Phi^n_{i+1}+\Phi_{i-1}^n-\Phi_i^n)+\Delta tS_i^n\]</span> 有时候可以用一个简写方法: <span class="math display">\[(\delta^2\Phi^n)_i=\Phi^n_{i+1}+\Phi^{n}_{i-1}-2\Phi_i^n\]</span> ##### 隐式差分法 <span class="math display">\[\begin{aligned}\frac{\Phi_i^{n+1}-\Phi_{i}^{n}}{\Deltat}=\frac{\Phi^{n+1}_{i+1}+\Phi^{n+1}_{i-1}-2\Phi_i^{n+1}}{h^2}+S^n_i\end{aligned}\]</span> 化简得到方程:( <span class="math inline">\(r=\frac{\Deltat}{h^2}\)</span> ) <span class="math display">\[-r\Phi_{i-1}^{n+1}+(1+2r)\Phi_i^{n+1}-r\Phi_{i+1}^{n+1}=\Phi_i^n+S_i^n\Deltat\]</span> 这样,如果知道了n对应的时间的分布(不同i对应的函数值),那么可以列线性方程组求解下一时刻的函数值。<strong>这个好像只适用于给定了第一类边界条件的情况</strong>。就是给定边界的函数值。如果给定了边界的值，假如说x方向分为了N+1个格点,第一个和最后一个格点的值已经知道了,那么可以列出一组线性方程。 <spanclass="math display">\[\begin{bmatrix}1+2r &amp; -r \\-r &amp; 1+2r&amp;-r\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;-r&amp;1+2r\\\end{bmatrix}\begin{bmatrix}\Phi_1^{n+1}\\\Phi_2^{n+1}\\ ..\\.. \\\Phi_{N-1}^{n+1}\end{bmatrix}=\begin{bmatrix}\Phi^n_{1}+S_{1}^n\Delta t+r\Phi_0^{n+1}\\ \Phi^n_{2}+S_{2}^n\Delta t \\\\ \\ \Phi^n_{N-1}+S_{N-1}^n\Delta t+r\Phi_N^{n+1}\end{bmatrix}\]</span></p><h5 id="平均隐式差分法crank-nicolson">平均隐式差分法Crank-Nicolson</h5><p>类似于隐士差分法,将输运方程的空间二阶导项写为新旧时刻所得值的结合。<span class="math display">\[\begin{aligned}\frac{\Phi_i^{n+1}-\Phi_{i}^{n}}{\Deltat}=(\frac{1}{2}(\Phi^{n+1}_{i+1}+\Phi^{n+1}_{i-1}-2\Phi_i^{n+1})+\frac{1}{2}(\Phi^{n}_{i+1}+\Phi^{n}_{i-1}-2\Phi_i^{n}))\frac{1}{h^2}+S^n_i\end{aligned}\]</span> 类似于隐式差分,得到一组线性方程 <span class="math display">\[\begin{aligned}&amp;\begin{bmatrix}1+r &amp; -r/2 \\-r/2 &amp; 1+r&amp;-r/2\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;-r/2&amp;1+r\\\end{bmatrix}\begin{bmatrix}\Phi_1^{n+1}\\\Phi_2^{n+1}\\ ..\\.. \\\Phi_{N-1}^{n+1}\end{bmatrix}\\&amp;\quad\quad=\begin{bmatrix}\frac{1}{2}r\Phi_0^n+(1-r)\Phi^n_{1}+\frac{1}{2}r\Phi_2^n+S_{1}^n\Deltat+\frac{r}{2}\Phi_0^{n+1}\\\frac{1}{2}r\Phi_1^n+(1-r)\Phi^n_{2}+\frac{1}{2}r\Phi_3^n+S_{2}^n\Deltat \\ \\ \\\frac{1}{2}r\Phi_{N-2}^n+(1-r)\Phi^n_{N-1}+\frac{1}{2}r\Phi_N^n+S_{N-1}^n\Deltat+\frac{r}{2}\Phi_N^{n+1}\end{bmatrix}\end{aligned}\]</span></p><h5id="算符表示的平均隐式差分法crank-nicolson方法求解schrodinger方程">算符表示的平均隐式差分法(Crank-Nicolson)方法求解schrodinger方程</h5><p>我们的schrodinger方程 <span class="math display">\[i\hbar\frac{\partial }{\partialt}\Phi=-\frac{\hbar^2}{2m}\nabla^2\Phi+V\Phi\]</span> 如果取常数<span class="math inline">\(\hbar=1,2m=1\)</span>定义算符 <span class="math display">\[H\Phi_i^n=-\frac{1}{h^2}(\Phi_{i+1}^n+\Phi_{i-1}^n-2\Phi_i^n)+V_i\Phi_i^n\]</span> Schrodinger方程可以写为(用了隐式差分法) <spanclass="math display">\[\frac{\Phi_i^{n+1}-\Phi_i^{n}}{\Deltat}=-i\frac{H}{2}\Phi^{n+1}_{i}-i\frac{H}{2}\Phi^n_{i}\]</span> 上面的式子可以写为 <span class="math display">\[\begin{aligned}\Phi_i^{n+1}&amp;=\frac{1-\frac{i}{2}H\Delta t}{1+\frac{i}{2}H\Deltat}\Phi_i^{n}\\\Phi_i^{n+1}&amp;=(\frac{2}{1+\frac{i}{2}H\Delta t}-1)\Phi_i^n\end{aligned}\]</span> 如果再定义一个辅助变量: <span class="math display">\[\chi_i^n=\frac{2}{1+\frac{i}{2}H\Delta t}\Phi_i^n\]</span> 则有方程 <span class="math display">\[\begin{aligned}\chi_{i-1}^n+(-2+i\frac{2h^2}{\Deltat}-h^2V_i)\chi_i^n+\chi_{i+1}^n=i\frac{4h^2}{\Delta t}\Phi_i^n\\\Phi_{i}^{n+1}=\chi_i^n-\Phi_i^n\end{aligned}\]</span> 辅助变量的边界条件定义为<spanclass="math inline">\(\chi_0=\chi_N=0\)</span> 。 辅助变量对应的方程组。<span class="math display">\[\begin{bmatrix}r_1 &amp; 1 \\1 &amp; r_2&amp;1\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;...&amp;...\\...&amp;...&amp;...&amp;...&amp;1&amp;r_{N-1}\\\end{bmatrix}\begin{bmatrix}\chi_1^{n}\\\chi_2^{n}\\ ..\\.. \\\chi_{N-1}^{n}\end{bmatrix}=\begin{bmatrix}i\frac{4h^2}{\Delta t}\Phi_1^n-\chi_0^n\\ i\frac{4h^2}{\Deltat}\Phi_2^n\\..\\..\\ i\frac{4h^2}{\Delta t}\Phi_{N-1}^n-\chi_N^n\end{bmatrix}\]</span> ### 第六章分子动力学 #### Verlet算法算是分子动力学中的最核心的算法了吧。 有两种: * 速度verlet算法 *L.verlet算法 ##### L.verlet算法 牛顿第二定理 <spanclass="math display">\[\frac{d^2r}{dt^2}=\frac{F(t)}{m}\]</span> 利用三点法改写等式左端。同时速度用前后差分法来确定。 <spanclass="math display">\[\begin{aligned}\frac{r(t+h)+r(t-h)-2r(t)}{h^2}&amp;=F(t)/m\\r(t+h)&amp;=2r(t)-r(t-h)+h^2\frac{F(t)}{m}+O(h^4)\\P(t)&amp;=\frac{m}{2h}(r(t+h)-r(t-h))+O(h^2)\end{aligned}\]</span> 这种算法需要两个启动点,速度方面不需要启动点。 #####速度verlet算法 这个是最常用的verlet 算法。 利用匀加速运动的位移公式<span class="math display">\[\begin{aligned}r(t+h)=r(t)+hv(t)+\frac{h^2}{2}\frac{F(t)}{m}\\r(t-h)=r(t)-hv(t)+\frac{h^2}{2}\frac{F(t)}{m}\end{aligned}\]</span> 将第二个式子的时间向前推进h。 <span class="math display">\[r(t)=r(t+h)-hv(t+h)+\frac{h^2}{2}\frac{F(t+h)}{m}\]</span> 这个式子和第一个式子相加,可以得到速度的递推公式,同时坐标的地推公式就用简单的匀加速运动的公式。 <spanclass="math display">\[\begin{aligned}r(t+h)= r(t)+hv(t)+\frac{h^2}{2}\frac{F(t)}{m}\\v(t+h)=v(t)+h\frac{F(t)+F(t+h)}{2m}\end{aligned}\]</span> 上面的两个公式就是最常用的速度verlet算法。 #### 边界条件一般采用的是周期性边界条件,如果A是任意客观测量则周期边界条件的表达式为:<span class="math display">\[A(\vec{x})=A(\vec{x}+\vec{n}L)\]</span> #### 模拟流程 主要就是一点....对温度定义 <spanclass="math display">\[T= \frac{\bar{E_k}}{\frac{d}{2}Nk_B}\]</span></p><h3 id="蒙特卡洛方法">蒙特卡洛方法</h3><h4 id="蒙特卡洛方法算积分-重要抽样法">蒙特卡洛方法算积分,重要抽样法</h4><p>考察积分,按照蒙特卡洛方法的思想,我们想随机抽取x，然后得到被积函数的抽样平均值认为这就是被积函数在这个区间上的平均值。由于f(x)的函数值随着x的变化起伏比较大, 会使得计算误差大。 <spanclass="math display">\[I = \int_0^xf(x&#39;)dx&#39;\]</span> 做变量代换 后的积分可以写为 <span class="math display">\[I = \int_0^x\frac{f(x&#39;)}{w(x&#39;)}w(x&#39;)dx&#39;\]</span> 如果取<spanclass="math inline">\(y(x)=\int_0^xw(x&#39;)dx&#39;\)</span>,并且要求<spanclass="math inline">\(\int_0^xw(x&#39;)dx&#39;=1\)</span> <spanclass="math display">\[I = \int_0^1\frac{f(x&#39;(y))}{w(x&#39;(y))}dy\]</span> 至此相当于对积分做了一次积分变换。 然后我们在<spanclass="math inline">\([0,1]\)</span>的区间抽取N个样本y, 把样本叫做<spanclass="math inline">\(y_i,y_i\in[0,1]\)</span>。则积分可以表示为 <spanclass="math display">\[I = \frac{1}{N} \Sigma_1^N \frac{f(x&#39;(y_i))}{w(x&#39;(y_i))}\]</span></p><p>这个积分方法就叫做重要抽样法。<strong>解释这个方法为什么是对的</strong> ,这段话是定性的。当N很大是,可以看做<span class="math inline">\(y_i\)</span>在<spanclass="math inline">\([0,1]\)</span>上面均匀分布。在区间<spanclass="math inline">\(y\to y+dy\)</span>内, <spanclass="math inline">\(y_i\)</span>落入其中的概率(<strong>的期望</strong>)为<spanclass="math inline">\(\frac{dy}{1}\)</span>, 也就是说, 抽到应变量为<spanclass="math inline">\(\frac{f(x&#39;(y))}{w(x&#39;(y))}\)</span>,(<strong>严格来讲应该是<spanclass="math inline">\(\frac{f(x&#39;(y+\epsilondy))}{w(x&#39;(y+\epsilondy))}\)</span></strong>)的概率(<strong>的期望</strong>)为<spanclass="math inline">\(dy\)</span>。(<strong>求和化为积分的具体过程</strong>)那么,遍历整个积分区间<spanclass="math inline">\([0,1]\)</span>。积分是抽取到应变量的平均值也是积分值。</p><h4id="重要抽样法的数值方法1差分方法">重要抽样法的数值方法1,差分方法</h4><p>当我们选取的函数<spanclass="math inline">\(w(x)\)</span>不方便积分时, 重要抽样法就难以进行。在<span class="math inline">\([0,1]\)</span>的区间中选取<spanclass="math inline">\(M+1\)</span>个y点。可以表示为<spanclass="math inline">\(y^{i}=\frac{i}{M},i\in\{0,1...,M\}\)</span>。 由于<span class="math display">\[\frac{dy}{dx} = w(x)\]</span> 化简为差分方程 <span class="math display">\[\frac{y^{i+1}-y^{i}}{x^{i+1}-x^i}=w(x^i)\]</span> <span class="math display">\[x^{i+1}=x^i+\frac{1}{Mw(x^i)}\]</span> 利用上面的递推关系,结合起始点<spanclass="math inline">\(x^0=0\)</span>，可以得到<spanclass="math inline">\(x^i\)</span>的具体值。 <strong>当然,选取w(x)时,这里默认是保证了<spanclass="math inline">\(\int_0^xw(x&#39;)dx&#39;=1\)</span></strong></p><h4id="蒙特卡洛方法的数值方法2-von_neumann-舍选法">蒙特卡洛方法的数值方法2,Von_Neumann 舍选法</h4><p>我们想让抽取的x样本随x的分布按照<spanclass="math inline">\(w(x)\)</span>进行。选取函数<spanclass="math inline">\(w&#39;(x)\)</span>,满足<spanclass="math inline">\(w&#39;(x)&gt;w(x)\)</span>。 这个抽样这样进行: 1.在区间<span class="math inline">\([0,x]\)</span>中抽取随机数<spanclass="math inline">\(x_i\)</span> 2. 计算<spanclass="math inline">\(w&#39;(x_i)\)</span>和<spanclass="math inline">\(w(x_i)\)</span>。 3. 在区间<spanclass="math inline">\([0,1]\)</span>之间生成随机数<spanclass="math inline">\(\eta\)</span> 4. 比较<spanclass="math inline">\(\frac{w(x_i)}{w&#39;(x_i)}\)</span>和<spanclass="math inline">\(\eta\)</span> 5. 若<spanclass="math inline">\(\frac{w(x_i)}{w&#39;(x_i)}&gt;\eta\)</span>则这个<spanclass="math inline">\(x_i\)</span>保留, 否则再抽取下一个<spanclass="math inline">\(x_i\)</span> 实际操作时候<spanclass="math inline">\(w&#39;(x)=max_{x&#39;\in [0,x]} w(x&#39;)\)</span>是一个常数。 按照这个流程,保留下来的<spanclass="math inline">\(x_i\)</span>都倾向于集中在<spanclass="math inline">\(w(x_i)\)</span>大的地方。 <strong>当然,选取w(x)时,这里默认是保证了<spanclass="math inline">\(\int_0^xw(x&#39;)dx&#39;=1\)</span></strong></p><h4 id="重要抽样法计算多维积分-metropolis方法">重要抽样法计算多维积分,metropolis方法</h4><p>在多维空间中,这样选取随机点。 1. 确定空间中的重要性函数w(X)。 2.确定起始点<span class="math inline">\(X_0\)</span>,这个是一个列向量,或者说是一个坐标 3. 下一步<spanclass="math inline">\(X_{i+1}=X_i+\delta_r\)</span>。 其中<spanclass="math inline">\(\delta_r\)</span>是指对于X的每一个坐标都变化一个在<spanclass="math inline">\([-\delta,\delta]\)</span>中的随机数。 4. 在<spanclass="math inline">\([0,1]\)</span>中选取一个随机数 <spanclass="math inline">\(\eta\)</span>, 如果<spanclass="math inline">\(\frac{w(X_{i+1})}{w(X_i)}&gt;\eta\)</span>则保留<spanclass="math inline">\(X_{i+1}\)</span>。否则<spanclass="math inline">\(X_{i+1}=X_i\)</span>按照这个方法选取的随机数会倾向于到<spanclass="math inline">\(w(X)\)</span>大的地方去。 <strong>当然,选取w(x)时,这里默认是保证了<spanclass="math inline">\(\int_0^xw(x&#39;)dx&#39;=1\)</span></strong> *一个metropolis方法的例子(matlab) 是老师写的程序,这个程序考察了规定重要性<spanclass="math inline">\(w(x)=\frac{6}{5}(1-\frac{1}{2}x^2)\)</span>。第一个点取的是<span class="math inline">\(x=0.9\)</span>,然后将随机取得点的分布画出来和<spanclass="math inline">\(w(x)\)</span>进行对比。但是实际上这个程序没有体现出metropolis方法中的"行走"。fxt同学的代码是这样处理行走中的边界问题的。(见下一段代码),对游走的点分了类，边界的点有相应的游走步长。<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">function metropolis_2</span><br><span class="line">clear all</span><br><span class="line">close all</span><br><span class="line">clc</span><br><span class="line"></span><br><span class="line"><span class="attribute">x1</span>=0.9;</span><br><span class="line"><span class="attribute">delta</span>=5.5;</span><br><span class="line"><span class="attribute">w</span>=@(x1) 6/5*(1-0.5*x1.^2); %概率密度函数，与例题8相同</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span>=0;</span><br><span class="line"><span class="attribute">N</span>=5e5;</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:N</span><br><span class="line">    [x1]=my_metropolis(x1,delta,w);</span><br><span class="line">    <span class="attribute">n</span>=n+1;</span><br><span class="line">    xx(n)=x1; %将经历的x1值存储起来 </span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">%下面的程序判断metropolis算法生成的随机数分布是否符合分布函数</span><br><span class="line">%========================================================</span><br><span class="line"><span class="attribute">Num</span>=201;                                                %区间大小</span><br><span class="line"><span class="attribute">Max</span>=max(abs(xx))+10^-9                    %边界</span><br><span class="line"><span class="attribute">Min</span>=min(xx)*1.0                      %边界</span><br><span class="line"><span class="attribute">y</span>=zeros(1,Num);</span><br><span class="line"><span class="attribute">x</span>=linspace(Min,Max,Num);</span><br><span class="line"><span class="attribute">h</span>=x(2)-x(1);</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:length(xx)</span><br><span class="line">    <span class="attribute">index</span>=fix((xx(i)-Min)/h)+1; %判定xx(i)处于哪个子区间，fix为舍去小数取整运算</span><br><span class="line">    y(index)=y(index)+1;          %该子区间的随机数数目+1</span><br><span class="line">end</span><br><span class="line"><span class="attribute">f</span>=@(x1) 6/5*(1-0.5*x1.^2);            %精确值绘图</span><br><span class="line">figure,fplot(f,[Min,Max],<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">hold on;</span><br><span class="line"><span class="attribute">S</span>=interg(Min,Max,f)</span><br><span class="line"><span class="attribute">y</span>=y/length(xx)/h*S;  %生成的随机数的数目为n(length(xx))，走的总步数为N</span><br><span class="line">plot(x(1:Num-1),y(1:Num-1),<span class="string">&#x27;-*&#x27;</span>);title(<span class="string">&#x27;验证随机数的分布&#x27;</span>);</span><br><span class="line">legend(<span class="string">&#x27;精确分布&#x27;</span>,<span class="string">&#x27;随机数的分布&#x27;</span>)</span><br><span class="line">hold off</span><br><span class="line"></span><br><span class="line">function <span class="attribute">S</span>=interg(a,b,w) %w函数在[a,b]上的积分 </span><br><span class="line">    <span class="attribute">n</span>=10000;</span><br><span class="line">    h=(b-a)/n;</span><br><span class="line">    <span class="attribute">xx_h</span>=a:h:b;</span><br><span class="line">    <span class="attribute">ww</span>=w(xx_h);</span><br><span class="line">    %<span class="attribute">S</span>=sum(w(xx_h).*(b-a)/n)-w(a)*(b-a)/2/n-w(b)*(b-a)/2/n; %梯形算法</span><br><span class="line">    S=(4*sum(ww(2:2:n))+2*sum(ww(3:2:n-1))+ww(1)+ww(n+1))*h/3; %simpson积分公式</span><br><span class="line">%=========================================================================</span><br><span class="line"></span><br><span class="line">function [x1] = my_metropolis(x1,delta,w)</span><br><span class="line"><span class="attribute">x1t</span>=rand; %[0,1]区间产生随机数</span><br><span class="line"><span class="attribute">r</span>=w(x1t)/w(x1);</span><br><span class="line"><span class="keyword">if</span> rand&lt;r;</span><br><span class="line">   <span class="attribute">x1</span>=x1t;    </span><br><span class="line">end</span><br></pre></td></tr></table></figure></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[xnew,typenew]</span> = <span class="title">MH</span><span class="params">(x,delta,type,w)</span></span></span><br><span class="line"><span class="comment">% Metropolis Hastings Algorithm</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span></span><br><span class="line">    xnew = <span class="number">2</span>*delta*<span class="built_in">rand</span> + <span class="number">1</span><span class="number">-2</span>*delta; <span class="comment">% 对于第1类坐标,在[1-2δ,1]均匀分布中选取下一个点</span></span><br><span class="line"><span class="keyword">elseif</span> <span class="built_in">type</span> == <span class="number">2</span></span><br><span class="line">    xnew = <span class="number">2</span>*delta*<span class="built_in">rand</span>; <span class="comment">% 对于第2类坐标,在[0,2δ]均匀分布中选取下一个点</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    xnew = x + delta*(<span class="number">2</span>*<span class="built_in">rand</span><span class="number">-1</span>); <span class="comment">% 对于第3类坐标,在[x-δ,x+δ]均匀分布中选取下一个点</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">typenew = categorize(xnew,delta); <span class="comment">% 记录新点的类型和概率密度</span></span><br><span class="line">r = w(xnew)/w(x);</span><br><span class="line"><span class="keyword">if</span>  <span class="built_in">rand</span> &gt; r</span><br><span class="line">    xnew = x;</span><br><span class="line">    typenew = <span class="built_in">type</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">type</span> = <span class="title">categorize</span><span class="params">(x,delta)</span></span></span><br><span class="line"><span class="comment">% 随机游走者所处位置的分类</span></span><br><span class="line"><span class="keyword">if</span> x+delta &gt; <span class="number">1</span></span><br><span class="line">    <span class="built_in">type</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">elseif</span> x-delta &lt; <span class="number">0</span></span><br><span class="line">    <span class="built_in">type</span> = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">type</span> = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h4 id="蒙特卡洛方法计算ising-模型">蒙特卡洛方法计算Ising 模型</h4><ul><li>简单介绍Ising模型 二维Ising模型就是一个<spanclass="math inline">\(N_x\timesN_y=N\)</span>的格点每一个格点上面都有一个自旋, 记为<spanclass="math inline">\(S_{i,j}\)</span> 系统有一个哈密顿量可以写为<spanclass="math inline">\(H = -J\Sigma_{&lt;\alpha\beta&gt;}S_{\alpha}S_{\beta}-B\Sigma_{\alpha}S_{\alpha}\)</span>上面的式子中,<span class="math inline">\(&lt;\alpha\beta&gt;\)</span>指的是对所有相邻的连线求和。当然就此可以引入两种边界条件(周期边界条件, 螺旋边界条件) 一个分布的权重(重要性)<spanclass="math inline">\(w(S)=\frac{e^{-H(S)}}{Z}\)</span>,其中<spanclass="math inline">\(Z = \Sigma e^{-H(S)}\)</span> 。 二维Ising模型经过计算可以得到物理量和统计学期望之间的关系。 <spanclass="math display">\[\begin{aligned}M &amp;= &lt;\Sigma_{\alpha = 1}^N S_{\alpha}&gt;\\\chi &amp;= &lt;\Sigma_{\alpha = 1}^NS_{\alpha}^2&gt;-&lt;\Sigma_{\alpha = 1}^N S_{\alpha}&gt;^2\\E &amp;= &lt;H(S)&gt;\\C_B &amp;= &lt;H^2&gt;-&lt;H&gt;^2\end{aligned}\]</span></li></ul><p>Ising 模型用metropolis方法的具体操作 1. 选择一个初始的S的分布(构型)2. 选择一个格点{i,j}。 3. 改变{i,j}上的自旋(使他反号) 4.计算改变后的系统能量<spanclass="math inline">\(H&#39;=H+(2Jf+B)S_{\alpha}\)</span>,则改变前后的的权重比值可以写为<spanclass="math inline">\(r=\frac{w(S&#39;)}{w(S)}=e^{-S_{\alpha}(2Jf+B)}\)</span>,其中<span class="math inline">\(f =(S_{i-1,j}+S_{i+1,j}+S_{i,j+1},S_{i,j-1})\)</span>。实际上f只能有5个可以取得值(从-4到4,间隔2取值),然后<spanclass="math inline">\(S_{\alpha}\)</span>也只有两个可以取的值，综合来看,r只有十个值，将这十个值提前存储在列表里面可以节省计算时间。 5. 从<spanclass="math inline">\([0,1]\)</span>区间里面取值<spanclass="math inline">\(\eta\)</span>,如果<spanclass="math inline">\(\eta&lt;r\)</span>,则认为变化后的分布<spanclass="math inline">\(S_{i+1}\)</span>就是<spanclass="math inline">\(S_i\)</span>翻转了一个自旋；如果<spanclass="math inline">\(\eta&gt; r\)</span>, 则认为<spanclass="math inline">\(S_{i+1}\)</span>就是<spanclass="math inline">\(S_i\)</span>。 6.在进行了很多步之后就可以开始计算物理量了。</p><ul><li>下面是Ising模型的例子,选择格子在水平和竖直方向上的大小都为50，耦合强度和外磁场强度分别为J=0.3，B=0.热化扫描50次（此时不计算可观测量），数据分成10个小组，每组50个样本，每个样本的抽样间隔为5.<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">function Exapmple_Ising_model</span><br><span class="line">clear all</span><br><span class="line">close all</span><br><span class="line">clc</span><br><span class="line"></span><br><span class="line"><span class="attribute">NX</span>=6;NY=6; %格子尺寸</span><br><span class="line">J=[0.0:0.05:0.3,0.305:0.005:0.605,0.61:0.05:0.92]; </span><br><span class="line">%耦合强度，并不等间隔的原因是为了加强0.3-0.6段的计算</span><br><span class="line"><span class="attribute">B</span>=0.0;  %外磁场强度</span><br><span class="line"></span><br><span class="line"><span class="attribute">N_therm</span>=50; %热化扫描步数</span><br><span class="line"><span class="attribute">N_group</span>=10; %数据分组数目</span><br><span class="line"><span class="attribute">N_size</span>=50;   %每组样本数</span><br><span class="line"><span class="attribute">N_freq</span>=5;   %抽样间隔步数</span><br><span class="line"></span><br><span class="line"><span class="attribute">S</span>=zeros(NX,NY);</span><br><span class="line">[N,S]=initialize(NX,NY); %初始化格子的自旋</span><br><span class="line"><span class="attribute">S1</span>=S</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">iii</span>=1:length(J)</span><br><span class="line">    <span class="attribute">JJ</span>=J(iii); %依次取不同的J值,即不同的耦合强度</span><br><span class="line">    <span class="attribute">R</span>=zeros(5,2); %R数组用于存放接受概率值，有10个矩阵元，即PPT中的(2)式</span><br><span class="line">    <span class="attribute">R</span>=flip_probs(JJ,B);% %初始化R数组</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="attribute">i</span>=1:N_therm %做热化扫描</span><br><span class="line">        [S,accept]=thermal_sweep(NX,NY,S,R);</span><br><span class="line">         %accept/N   %反转操作接受率</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    <span class="attribute">S2</span>=S;</span><br><span class="line">    <span class="attribute">Sum_M</span>=0; <span class="attribute">Sum_M2</span>=0; <span class="attribute">Sum_SigM</span>=0; %初始化待求物理量M, E，Chi，CB</span><br><span class="line">    <span class="attribute">Sum_E</span>=0; <span class="attribute">Sum_E2</span>=0; <span class="attribute">Sum_SigE</span>=0;</span><br><span class="line">    <span class="attribute">Sum_Chi</span>=0; <span class="attribute">Sum_Chi2</span>=0;</span><br><span class="line">    <span class="attribute">Sum_CB</span>=0; <span class="attribute">Sum_CB2</span>=0;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="attribute">igroup</span>=1:N_group</span><br><span class="line">        <span class="attribute">Group_M</span>=0; <span class="attribute">Group_M2</span>=0;</span><br><span class="line">        <span class="attribute">Group_E</span>=0; <span class="attribute">Group_E2</span>=0;</span><br><span class="line">        <span class="keyword">for</span> <span class="attribute">sweep</span>=1:N_size*N_freq  %完成此轮循环，就完成了一组数值的计算</span><br><span class="line">            [S,accept]=thermal_sweep(NX,NY,S,R); %抽样前，先做热化扫描</span><br><span class="line">            %accept/N   %反转操作接受率</span><br><span class="line">            <span class="keyword">if</span> mod(sweep,N_freq)==0</span><br><span class="line">                [Magic,Energy]=Magic_Energy(B,JJ,NX,NY,S); %求出一种情况下的磁化强度和能量E</span><br><span class="line">                %一次抽样，获得M和E</span><br><span class="line">                <span class="attribute">Group_M</span>=Group_M+Magic;</span><br><span class="line">                <span class="attribute">Group_M2</span>=Group_M2+Magic^2;</span><br><span class="line">                <span class="attribute">Group_E</span>=Group_E+Energy;</span><br><span class="line">                <span class="attribute">Group_E2</span>=Group_E2+Energy^2;</span><br><span class="line">            end</span><br><span class="line">        end</span><br><span class="line">    %===================================</span><br><span class="line">        <span class="attribute">Group_M</span>=Group_M/N_size; %组内抽样的平均，即期望值，PPT中的（1）式，教材中的(8.21a)</span><br><span class="line">        <span class="attribute">Group_M2</span>=Group_M2/N_size;</span><br><span class="line">        <span class="attribute">Group_E</span>=Group_E/N_size;</span><br><span class="line">        <span class="attribute">Group_E2</span>=Group_E2/N_size;</span><br><span class="line">        <span class="attribute">Chi</span>=Group_M2-Group_M^2; %(8.21b),一个组里面求得的磁化率</span><br><span class="line">        <span class="attribute">CB</span>=Group_E2-Group_E^2;  %(8.21d)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">Sum_M</span>=Sum_M+Group_M;</span><br><span class="line">        <span class="attribute">Sum_E</span>=Sum_E+Group_E;</span><br><span class="line">        <span class="attribute">Sum_Chi</span>=Sum_Chi+Chi;</span><br><span class="line">        <span class="attribute">Sum_CB</span>=Sum_CB+CB;</span><br><span class="line">    end</span><br><span class="line">    <span class="attribute">E</span>=Sum_E/N_group;</span><br><span class="line">    <span class="attribute">M</span>=Sum_M/N_group;</span><br><span class="line">    <span class="attribute">Chi</span>=Sum_Chi/N_group;         %几个组求得的磁化率的平均</span><br><span class="line">    <span class="attribute">CB</span>=Sum_CB/N_group;</span><br><span class="line"></span><br><span class="line">    CBB(iii)=CB; %用于存储不同J值对应的CB比热容</span><br><span class="line">    EE(iii)=E/N; %N为总格子数</span><br><span class="line">    MM(iii)=M/N;</span><br><span class="line">    Chi_1(iii)=Chi/N;</span><br><span class="line"></span><br><span class="line">end   %对应于<span class="keyword">for</span> <span class="attribute">iii</span>=1:length(J)</span><br><span class="line"> figure;plot(1./J,CBB,<span class="string">&#x27;r*-&#x27;</span>) %注意：由于1/0为无穷大，程序没有画出该点</span><br><span class="line"> title(<span class="string">&#x27;比热随耦合强度的倒数的变化关系&#x27;</span>)</span><br><span class="line"> xlabel(<span class="string">&#x27;1/J&#x27;</span>); ylabel(<span class="string">&#x27;C_B&#x27;</span>);</span><br><span class="line"> figure;plot(1./J,EE,<span class="string">&#x27;b&#x27;</span>)       %J值大，意味着温度低，M值大</span><br><span class="line"> title(<span class="string">&#x27;能量随耦合强度的倒数的变化关系&#x27;</span>)</span><br><span class="line"> xlabel(<span class="string">&#x27;1/J&#x27;</span>); ylabel(<span class="string">&#x27;能量E&#x27;</span>);</span><br><span class="line"> figure;plot(1./J,MM,<span class="string">&#x27;r&#x27;</span>) %注意，磁化强度可以朝不同方向，因此可以为负</span><br><span class="line"> title(<span class="string">&#x27;磁化强度随耦合强度的倒数的变化关系&#x27;</span>)</span><br><span class="line"> xlabel(<span class="string">&#x27;1/J&#x27;</span>); ylabel(<span class="string">&#x27;磁化强度M&#x27;</span>);</span><br><span class="line"> figure;plot(1./J,Chi_1,<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line"> title(<span class="string">&#x27;磁化率随耦合强度的倒数的变化关系&#x27;</span>)</span><br><span class="line"> xlabel(<span class="string">&#x27;1/J&#x27;</span>); ylabel(<span class="string">&#x27;磁化率Chi&#x27;</span>);</span><br><span class="line"> S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function [N,S]=initialize(NX,NY)   %初始化每个格子的自旋</span><br><span class="line"><span class="attribute">N</span>=NX*NY;</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:NY</span><br><span class="line">    <span class="keyword">for</span> <span class="attribute">j</span>=1:NX</span><br><span class="line">        <span class="keyword">if</span> rand &lt; 0.5</span><br><span class="line">            S(i,j)=1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            S(i,j)=-1;</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">function [Magic,Energy]=Magic_Energy(B,JJ,NX,NY,S)  %求出一种情况下的磁化强度和能量E</span><br><span class="line"><span class="attribute">Magic</span>=0;</span><br><span class="line"><span class="attribute">Sum_ss</span>=0;</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:NY</span><br><span class="line">    <span class="keyword">if</span> i&gt;1</span><br><span class="line">        <span class="attribute">IM</span>=i-1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="attribute">IM</span>=NY;</span><br><span class="line">    end</span><br><span class="line">    %====================</span><br><span class="line">    <span class="keyword">for</span> <span class="attribute">j</span>=1:NX</span><br><span class="line">        <span class="keyword">if</span> j&gt;1</span><br><span class="line">            <span class="attribute">JM</span>=j-1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="attribute">JM</span>=NX;</span><br><span class="line">        end</span><br><span class="line">        %==================</span><br><span class="line">        <span class="attribute">Magic</span>=Magic+S(i,j);</span><br><span class="line">        <span class="attribute">Sum_ss</span>=Sum_ss+S(i,j)*(S(IM,j)+S(i,JM)); </span><br><span class="line">        %注意上式求和实际上是进行(8.18)式第一项的运算，但S(i,j)只与左格点和上格点相乘求和</span><br><span class="line">        %是因为如果上下左右四个格点都相乘求和，则存在重复计算的现象</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line"><span class="attribute">Energy</span>=-JJ*Sum_ss-B*Magic; %(8.18)式</span><br><span class="line">        </span><br><span class="line">function <span class="attribute">R</span>=flip_probs(JJ,B) %设定翻转判定矩阵</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:5</span><br><span class="line">    R(i,2)=exp(-2*(JJ*(2*i-6)+B));  %Sa为1</span><br><span class="line">    %自旋反转判定因子，page 147页的（8.23）式，PPT中的（2）式，R(:,2)代表中心点自旋向上</span><br><span class="line">    R(i,1)=exp(2*(JJ*(2*i-6)+B)); %分别对应于<span class="attribute">f</span>=-4，-2, 0, 2, 4</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">function [S,accept]=thermal_sweep(NX,NY,S,R)   </span><br><span class="line">%热化扫描函数，每次热化扫描后，所有的点都被遍历一次</span><br><span class="line"><span class="attribute">accept</span>=0;</span><br><span class="line"><span class="keyword">for</span> <span class="attribute">i</span>=1:NY</span><br><span class="line">    <span class="keyword">if</span> i&lt;NY         %采用周期性边界条件，此<span class="keyword">if</span>循环给定(i,j)粒子下面的相邻格点（i+1,j）</span><br><span class="line">        <span class="attribute">IP</span>=i+1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="attribute">IP</span>=1;</span><br><span class="line">    end</span><br><span class="line">    <span class="keyword">if</span> i&gt;1         %采用周期性边界条件，此<span class="keyword">if</span>循环给定(i,j)粒子上面的相邻格点（i-1,j）</span><br><span class="line">        <span class="attribute">IM</span>=i-1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="attribute">IM</span>=NY;</span><br><span class="line">    end</span><br><span class="line">    %==================</span><br><span class="line">    <span class="keyword">for</span> <span class="attribute">j</span>=1:NX</span><br><span class="line">        <span class="keyword">if</span> j&lt;NX %采用周期性边界条件，此<span class="keyword">if</span>循环给定(i,j)粒子右边的相邻格点（i,j+1）</span><br><span class="line">            <span class="attribute">JP</span>=j+1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="attribute">JP</span>=1;</span><br><span class="line">        end</span><br><span class="line">        <span class="keyword">if</span> j&gt;1 %采用周期性边界条件，此<span class="keyword">if</span>循环给定(i,j)粒子左边的相邻格点（i,j-1）</span><br><span class="line">            <span class="attribute">JM</span>=j-1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="attribute">JM</span>=NX;</span><br><span class="line">        end</span><br><span class="line">        %==================</span><br><span class="line">        <span class="attribute">spin</span>=S(i,j);     </span><br><span class="line">        <span class="attribute">f</span>=S(IP,j)+S(IM,j)+S(i,JP)+S(i,JM);</span><br><span class="line">        <span class="keyword">if</span> rand&gt;R(3+f/2,(3+spin)/2) %如果反转概率比随机数小，则不反转</span><br><span class="line">            %注意：f的取值只有-4，-2,0,2,4五种，spin只有-1,1两种，</span><br><span class="line">            %因此用R（5,2）二维数组即可以判定是否反转</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            S(i,j)=-spin;  %反转(i,j)点的自旋</span><br><span class="line">            <span class="attribute">accept</span>=accept+1;</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure></li></ul><h3 id="典型的例子">典型的例子</h3><p>在作业文件夹中有一个"自定义函数"的子文件夹,里面有很多实用的,暂时没有搬到笔记里面来。</p><h4 id="rk算法">4-RK算法</h4><p>写了一个函数文件,可以以后调用。 <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%这里是想写一个给定初态,分段,分段数目,函数迭代表达式,就可以返回函数自变量和因变量。</span></span><br><span class="line"><span class="comment">%f,可以是多因变量的,但是目前只支持单自变量。f的定义格式可以是f = @(x,y)[dy1/dx(x,y)  ,dy2/dx(x,y) ...]</span></span><br><span class="line"><span class="comment">%y 是因变量,这里要写成行变量的形式。[y1,y2...]</span></span><br><span class="line"><span class="comment">%x_start是x的起始点</span></span><br><span class="line"><span class="comment">%x_end是x的终止点</span></span><br><span class="line"><span class="comment">%n 是分段的数目,相当于自变量列表的数目是n+1</span></span><br><span class="line"><span class="comment">%支持倒序解</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[x,y]</span>= <span class="title">RK_solution</span><span class="params">(x_start,x_end,y_start,n,f)</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    h=(x_end-x_start)/n;</span><br><span class="line">    x=x_start:h:x_end;</span><br><span class="line"></span><br><span class="line">    <span class="comment">%通过这个变量(length)得到函数的因变量。  </span></span><br><span class="line">    <span class="built_in">length</span> = <span class="built_in">size</span>(y_start,<span class="number">2</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%将因变量定义为元素为0的矩阵。</span></span><br><span class="line">    y = <span class="built_in">zeros</span>(n+<span class="number">1</span>,<span class="built_in">length</span>);</span><br><span class="line">    <span class="comment">%将函数因变量的第一行写为初态。</span></span><br><span class="line">    y(<span class="number">1</span>,:)=y_start;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%利用R-K算法迭代</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">1</span>:n</span><br><span class="line">        xn=x(<span class="built_in">i</span>);</span><br><span class="line">        yn=y(<span class="built_in">i</span>,:);</span><br><span class="line">    </span><br><span class="line">        K1 = f(xn,yn);</span><br><span class="line">        K2 = f(xn+h/<span class="number">2</span>,yn+h/<span class="number">2.</span>*K1);</span><br><span class="line">        K3= f(xn+h/<span class="number">2</span>,yn+h/<span class="number">2.</span>*K2);</span><br><span class="line">        K4= f(xn+h,yn+h.*K3);</span><br><span class="line">        </span><br><span class="line">        y(<span class="built_in">i</span>+<span class="number">1</span>,:)=yn+h/<span class="number">6.</span>*(K1+<span class="number">2.</span>*K2+<span class="number">2.</span>*K3+K4);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p><h4 id="simpson38积分法">Simpson38积分法</h4><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">% 定义simpson38算法的积分,算法可以做到给定函数和自变量数组就可以,需要注意的是x中的元素个数一定要是。<span class="number">3</span>的倍数+<span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">I_simpson38</span> = <span class="title">simpson38</span><span class="params">(x,f1)</span></span></span><br><span class="line"><span class="function">    <span class="title">I_simpson38</span>=3/8*<span class="title">abs</span><span class="params">(x(2)</span>-<span class="title">x</span><span class="params">(1)</span>)*<span class="params">(f1(1)</span>+3*<span class="title">sum</span><span class="params">(f1(2:3:<span class="keyword">end</span>-2)</span>)+3*<span class="title">sum</span><span class="params">(f1(3:3:<span class="keyword">end</span>-1)</span>)+2*<span class="title">sum</span><span class="params">(f1(4:3:<span class="keyword">end</span>-3)</span>)+<span class="title">f1</span><span class="params">(<span class="keyword">end</span>)</span>);</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h4 id="简单搜索发结合二分法">简单搜索发结合二分法</h4><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">% 定义一个二分法结合简单搜索发寻找哦函数f从xstart到xend之间所有的根,并且寻找到的根的数目可以自定义为nmax.</span><br><span class="line">%搜索法的起始搜索步长设定为h。</span><br><span class="line">% xstart表示开始寻找的x值,xend表示最终搜索的x值,h表示搜索步长,f表示需要求根的函数,delta和<span class="built_in">epsilon</span>都表示误差。</span><br><span class="line"><span class="function"><span class="keyword">function</span></span> positions = finding(xstart,xend,nmax,f,delta,<span class="built_in">epsilon</span>,h)</span><br><span class="line">    positions = [];</span><br><span class="line">    <span class="keyword">number</span> = <span class="built_in">size</span>(positions,<span class="number">2</span>);</span><br><span class="line">    x0 = xstart;</span><br><span class="line">    h1 = h;</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">number</span> &lt; nmax &amp; x0 &lt; xend</span><br><span class="line">        h = h1;</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">abs</span>(f(x0)) &gt; delta | <span class="built_in">abs</span>(h) &gt; <span class="built_in">epsilon</span></span><br><span class="line">                        </span><br><span class="line">            <span class="keyword">if</span> f(x0)*f(x0+h)&gt;<span class="number">0</span></span><br><span class="line">                x0 = x0 + h;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                h = h/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">position</span> = [x0];</span><br><span class="line">        positions = [positions,<span class="keyword">position</span>];</span><br><span class="line">        <span class="keyword">number</span> = <span class="built_in">size</span>(positions,<span class="number">2</span>);</span><br><span class="line">        x0 = x0 + h1;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h4 id="薛定谔方程的本征值问题">薛定谔方程的本征值问题</h4><p><strong>[[计算物理#求解薛定谔方程的本征值问题|前面章节讲到的打靶法]]</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%[energy,x,y] = find_energy(x_min,x_max,h,v,gamma,n,delta,delta_judge,epsilon,e_start,e_end,e_max,y1a,y1b)</span></span><br><span class="line"><span class="comment">%定义了一个函数叫做&quot;find_energy&quot;,他的作用是求解schrodinger方程的本征值问题。下面解释各个输入参数的意思。</span></span><br><span class="line"><span class="comment">%--------输入</span></span><br><span class="line"><span class="comment">%x_min,x_max分别表示求解薛定谔方程的区间,</span></span><br><span class="line"><span class="comment">%h表示初始的搜索步长(用于简单搜索法和二分法的结合)。h在这个算法中既是寻找xm的搜索步长,也是寻找能量本征值的搜索步长。</span></span><br><span class="line"><span class="comment">%v是定义的势能函数</span></span><br><span class="line"><span class="comment">% gamma是薛定谔方程无量纲化后的系数</span></span><br><span class="line"><span class="comment">%n是解薛定谔方程(从xmin到xm,和从xm到xmax)时的分段个数(注意分段个数一定是3的倍数(n是3的倍数);这是因为用了simson38算法)</span></span><br><span class="line"><span class="comment">%delta,epsilon 是二分法的delta,epsilon</span></span><br><span class="line"><span class="comment">%delta_judge是判断是否为阶跃点的判断标准!!!!!!!--------这个比较关键,因为这个关系到跳跃函数间断点。这个系数取的过小会漏掉一些本征值,取得过的大会增加计算时间。一般取8-100。</span></span><br><span class="line"><span class="comment">%e_start是寻找能量本征值的起点</span></span><br><span class="line"><span class="comment">%e_end是寻找能量本征值的终点(找到这个能量就停止)</span></span><br><span class="line"><span class="comment">%e_max是寻找能量本征值的最大数目(找到这个数目就停止)</span></span><br><span class="line"><span class="comment">%y1a,y1b是该算法中在xmin和xmax处薛定谔方程的初态,用列表的形式给出。详细见RK_solution 函数</span></span><br><span class="line"><span class="comment">%--------输出</span></span><br><span class="line"><span class="comment">%energy是一个行向量,从左到右,从小到大输出能量本征值</span></span><br><span class="line"><span class="comment">%x是一个列表,第i行是第i个本征值对应的本征态。</span></span><br><span class="line"><span class="comment">%y是一个列表,第i行是第i个本征值对应的本征态</span></span><br><span class="line"><span class="comment">%--------这个函数中引用了其它函数</span></span><br><span class="line"><span class="comment">%finding 是二分法结合简单搜索法的函数</span></span><br><span class="line"><span class="comment">%RK-Solution是用4-RK算法求解方程的函数。</span></span><br><span class="line"><span class="comment">%simpson38是辛普森3/8积分算法</span></span><br><span class="line"><span class="comment">% --------输入的例子</span></span><br><span class="line"><span class="comment">%下面的输入意味着在(-4,4)区间上,gamma是sqrt(50)，解势能函数为v(x)，的薛定谔方程,并且我们考察前六个能量本征值,最大的能量本征值不超过6。</span></span><br><span class="line"><span class="comment">%按照这个例子,会解出能量本征值和归一化的本征态,并且画出各个本征态的波函数。</span></span><br><span class="line"><span class="comment">%v = @(x)1/2.*x.^2-1</span></span><br><span class="line"><span class="comment">%[energy,x,y]=find_energy(-4,4,0.01,v,sqrt(50),300,0.01,50,0.01,-0.9990,6,6,[0,0.1],[0,0.1])</span></span><br><span class="line"><span class="comment">%number = size(energy,2)</span></span><br><span class="line"><span class="comment">%for i = 1:1:number</span></span><br><span class="line"><span class="comment">%    figure;</span></span><br><span class="line"><span class="comment">%    plot(x(i,:),y(i,:),&#x27;r&#x27;)</span></span><br><span class="line"><span class="comment">%end</span></span><br><span class="line"><span class="comment">%plot(x(1,:),v(x(1,:)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[energy,x,y]</span> = <span class="title">find_energy</span><span class="params">(x_min,x_max,h,v,gamma,n,delta,delta_judge,epsilon,e_start,e_end,e_max,y1a,y1b)</span></span></span><br><span class="line">   </span><br><span class="line">    energy = [];</span><br><span class="line">    x = [];</span><br><span class="line">    y = [];</span><br><span class="line">    number = <span class="built_in">size</span>(energy,<span class="number">2</span>);</span><br><span class="line">    e0 = e_start;</span><br><span class="line">    h1 = h;</span><br><span class="line">    delta1 = delta;</span><br><span class="line">    <span class="keyword">while</span> number &lt; e_max &amp;&amp; e0&lt; e_end</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">        h1 = h;</span><br><span class="line">        delta1 = delta;</span><br><span class="line">        delta_judge1 = delta_judge;</span><br><span class="line">        [x0,y0,judge0]= solution_function(x_min,x_max,e0);</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">abs</span>(judge0) &gt; delta1 | <span class="built_in">abs</span>(h1) &gt; epsilon ) &amp; e0 &lt; e_end</span><br><span class="line">            [x0,y0,judge0]= solution_function(x_min,x_max,e0);</span><br><span class="line">            [x1,y1,judge1]= solution_function(x_min,x_max,e0+h1);                        </span><br><span class="line">            judge1;</span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">1</span> &amp; <span class="built_in">abs</span>(judge1)&gt; delta_judge1</span><br><span class="line">                e0 = e0+h;</span><br><span class="line">                count = <span class="number">0</span>;</span><br><span class="line">                delta1 = delta;</span><br><span class="line">                h1 = h;</span><br><span class="line">                delta_judge1 = delta_judge;</span><br><span class="line">                [x0,y0,judge0]= solution_function(x_min,x_max,e0);</span><br><span class="line">                [x1,y1,judge1]= solution_function(x_min,x_max,e0+h1); </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">if</span> judge0*judge1&lt;<span class="number">0</span> </span><br><span class="line">                h1 = h1/<span class="number">2</span>;</span><br><span class="line">                count = count+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> count == <span class="number">1</span></span><br><span class="line">                    delta1 = delta1*(<span class="built_in">abs</span>(judge0)+<span class="built_in">abs</span>(judge1))/<span class="number">2</span>;</span><br><span class="line">                    delta_judge1 = <span class="built_in">min</span>([<span class="built_in">abs</span>(judge0),<span class="built_in">abs</span>(judge1)]).*delta_judge1;            </span><br><span class="line">                <span class="keyword">end</span>            </span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                e0 = e0+h1;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> e0 &lt; e_end</span><br><span class="line">            e = [e0];</span><br><span class="line">            energy = [energy,e];</span><br><span class="line">            x = [x;x0];</span><br><span class="line">            y2 = y0.^<span class="number">2</span>;</span><br><span class="line">            I = simpson38(x0(<span class="number">1</span>:n+<span class="number">1</span>),y2(<span class="number">1</span>:n+<span class="number">1</span>)) + simpson38(x0(n+<span class="number">1</span>:<span class="number">2</span>*n+<span class="number">1</span>),y2(n+<span class="number">1</span>:<span class="number">2</span>*n+<span class="number">1</span>));</span><br><span class="line">            y0 = y0./<span class="built_in">sqrt</span>(I);</span><br><span class="line">            y = [y;y0];</span><br><span class="line">            number = <span class="built_in">size</span>(energy,<span class="number">2</span>);</span><br><span class="line">            e0 = e0 + h;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">xm</span> = <span class="title">find_xm</span><span class="params">(e)</span></span></span><br><span class="line">        f = @(x)(e-v(x));</span><br><span class="line">        xm = finding(x_min,x_max,<span class="number">1</span>,f,delta,epsilon,h);</span><br><span class="line">        xm = xm(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="params">[x,y,judge]</span> = <span class="title">solution_function</span><span class="params">(x_min,x_max,e)</span></span></span><br><span class="line">        xm = find_xm(e);</span><br><span class="line">        f = @(x,y)[y(<span class="number">2</span>),-<span class="built_in">gamma</span>^<span class="number">2</span>*(e-v(x))*y(<span class="number">1</span>)];</span><br><span class="line">        [xl,yl]=RK_solution(x_min,xm,y1a,n,f);</span><br><span class="line">        [xr,yr]=RK_solution(x_max,xm,y1b,n,f);</span><br><span class="line">        xr = flip(xr);</span><br><span class="line">        yr = flip(yr,<span class="number">1</span>);</span><br><span class="line">        yl = yl(:,<span class="number">1</span>)&#x27;;</span><br><span class="line">        yr = yr(:,<span class="number">1</span>)&#x27;;</span><br><span class="line">        x = [xl,xr(<span class="number">2</span>:n+<span class="number">1</span>)];</span><br><span class="line">        yr = yr.*(yl(n+<span class="number">1</span>)/yr(<span class="number">1</span>));</span><br><span class="line">        y = [yl,yr(<span class="number">1</span>,<span class="number">2</span>:n+<span class="number">1</span>)];</span><br><span class="line">        judge = (y(n+<span class="number">2</span>)-y(n+<span class="number">1</span>))/(x(n+<span class="number">2</span>)-x(n+<span class="number">1</span>))-(y(n+<span class="number">1</span>)-y(n))/(x(n+<span class="number">1</span>)-x(n));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p><strong>索末菲方法</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%sommerfeld_energy = sommerfeld(n,v,gamma,h,delta,epsilon,x_l,x_r,e_start) </span></span><br><span class="line"><span class="comment">%--------输入</span></span><br><span class="line"><span class="comment">% n代表态,n=0表示基态,v代表势能函数,gamma代表系数。h是能量的搜索步长,也是无量纲化后寻找经典允许区域边界的搜索步长。x_l是寻找允许区左边界的启动点,x_r是寻找允许区右边界的搜索启动点,x_start是能量本征值的修锁启动点。</span></span><br><span class="line"><span class="comment">%--------输出</span></span><br><span class="line"><span class="comment">%会输出一个具体的数,代表着这个态的能量本征值。</span></span><br><span class="line"><span class="comment">%--------例子</span></span><br><span class="line"><span class="comment">%v = @(x)4*(x.^(-12)-x.^(-6))</span></span><br><span class="line"><span class="comment">%sommerfeld_energy = sommerfeld(1,v,20,0.01,0.01,0.01,0.999,2^(1/6),-0.9999)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sommerfeld_energy</span> = <span class="title">sommerfeld</span><span class="params">(n,v,gamma,h,delta,epsilon,x_l,x_r,e_start)</span> </span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">%start1,start3后来被用来简单搜索法的启动点(搜索xin,xout)</span></span><br><span class="line">    <span class="comment">%start1 = 0.999;</span></span><br><span class="line">    <span class="comment">%start3 = 2^(1/6);</span></span><br><span class="line">    <span class="comment">%start5 = -1;</span></span><br><span class="line"></span><br><span class="line">    start1 = x_l;</span><br><span class="line">    start3 = x_r;</span><br><span class="line">    start5 = e_start;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%定义精度和寻找步长</span></span><br><span class="line">    <span class="comment">%epsilon = 0.001;</span></span><br><span class="line">    <span class="comment">%delta = 0.0001;</span></span><br><span class="line">    <span class="comment">%h = 0.0001;</span></span><br><span class="line"></span><br><span class="line">    y = @(x)integrate(<span class="built_in">gamma</span>,x,start1,start3,h,delta)-(n+<span class="number">1</span>/<span class="number">2</span>)*<span class="built_in">pi</span>;</span><br><span class="line">    sommerfeld_energy = simple(y,start5,h,delta);</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">I_simpson38</span>  = <span class="title">integrate</span><span class="params">(gamma,epsn,start1,start3,h,delta)</span></span></span><br><span class="line">        y0 = @(x)epsn-v(x);</span><br><span class="line">        xin = simple(y0,start1,h,delta);</span><br><span class="line">        xout = simple(y0,start3,h,delta);</span><br><span class="line">        y1 = @(x)<span class="built_in">gamma</span>*(epsn-v(x)).^(<span class="number">1</span>/<span class="number">2</span>);</span><br><span class="line">        N = <span class="number">600</span>;</span><br><span class="line">        H = (xout-xin)/N;</span><br><span class="line">        x = xin:H:xout; </span><br><span class="line">        f1 = y1(x);</span><br><span class="line">        I_simpson38=<span class="number">3</span>/<span class="number">8</span>*H*(f1(<span class="number">1</span>)+<span class="number">3</span>*sum(f1(<span class="number">2</span>:<span class="number">3</span>:<span class="keyword">end</span><span class="number">-2</span>))+<span class="number">3</span>*sum(f1(<span class="number">3</span>:<span class="number">3</span>:<span class="keyword">end</span><span class="number">-1</span>))+<span class="number">2</span>*sum(f1(<span class="number">4</span>:<span class="number">3</span>:<span class="keyword">end</span><span class="number">-3</span>))+f1(<span class="keyword">end</span>));  </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">position</span>=<span class="title">simple</span><span class="params">(f, x0, h, delta)</span> </span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">abs</span>(f(x0)) &gt; delta</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> f(x0)*f(x0+h)&gt;<span class="number">0</span></span><br><span class="line">            x0 = x0 + h;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            h = h/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        position = x0;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 物理中的数学技巧 </category>
          
          <category> 计算物理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算物理 </tag>
            
            <tag> matlab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>量子场论笔记</title>
      <link href="/2024/06/10/liang-zi-chang-lun-bi-ji/"/>
      <url>/2024/06/10/liang-zi-chang-lun-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>不知道为什么，这个pdf在网页中的显示效果并不好，我觉得在chrome浏览器中显示效果好一些，在safari浏览器中，可以把pdf下载下来，将鼠标移动到pdf底部的中间部分可以弹出下载按钮，需要后面再调整吧。</p><p>可以点击这个链接下载：<a href="QFT.pdf">下载链接</a></p><embed src="./QFT.pdf" width="100%" height="900" type="application/pdf">]]></content>
      
      
      <categories>
          
          <category> 量子场论 </category>
          
          <category> 读书笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 量子力学 </tag>
            
            <tag> QFT </tag>
            
            <tag> 量子场论 </tag>
            
            <tag> 泛函 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一个测试文章</title>
      <link href="/2024/06/10/di-yi-ge-ce-shi-wen-zhang/"/>
      <url>/2024/06/10/di-yi-ge-ce-shi-wen-zhang/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/06/10/hello-world/"/>
      <url>/2024/06/10/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your veryfirst post. Check <a href="https://hexo.io/docs/">documentation</a> formore info. If you get any problems when using Hexo, you can find theanswer in <ahref="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> oryou can ask me on <ahref="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start">Quick Start</h2><h3 id="create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <ahref="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <ahref="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <ahref="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
